#INCLUDE "PROTHEUS.CH"
#INCLUDE "TOPCONN.CH"
#include "TBICONN.CH"

#define ENTER CHR(13)+CHR(10)

Static nVLOutEnt := 0

*=====================================================================================================================================*
/*/{Protheus.doc} GTFIN038
//TODO Fonte para tratamento de funções com retorno TEXTO no processo de CNAB via ACCESSTAEG:
nOPCAO := 1 "U_NOEMP() - FAZ O TRATAMENTO PARA RETORNAR APENAS O PRIMEIRO NOME DA EMPRESA DO SIGAMAT.EMP (CHAMADO NO CAMPO)" 
nOPCAO := 2 "U_PARBCO() - TRATAMENTO DOS CAMPOS DO PARAMETROS DO BANCO (FINA130) EM CASO DE SELEÇÃO DE ACCESSTAGE COMO "SIM", PREENCHENDO ALGUNS CAMPOS COM DADOS PADRÕES. (CHAMADO NO CAMPO)" 
nOPCAO := 3 "U_ACCESST(cPergunt) - FUNÇÃO PARA AUTO PREENCHIMENTO DOS PERGUNTES "AFI420,AFI430,AFI150 E AFI200" COM O NOME DO ARQUIVO DE CONFIG E O DIRETÓRIO DE SAIDA E NOME DO ARQUIVO CNAB"
nOPCAO := 4 "U_LAYCNAB() - FUNÇÃO QUE CRIA O ARQUIVO DE LAYOUT DO CNAB PARA REMESSA DE PAGAMENTO/COBRANÇA E RETORNO DE PAGAMENTO/COBRANÇA PADRÃO FEBRABAN"
nOPCAO := 5 "U_INFOTRIB() - FUNÇÃO CHAMADA NO ARQUIVO DE LAYOUT CNAB NO TRECHO ONDE MONTA AS INFORMAÇÕES DE TRIBUTOS (CHAMADO NO ARQUIVO DE LAYOUT FEBRABAN)"
nOPCAO := 6 "U_INFOCOMP() - FUNÇÃO CHAMADO NO ARQUIVO DE LAYOUT CANB NO TRECHO ONDE MONTA AS INFORMAÇÕES COMPLEMENTARES DO PAGAMENTO DE FGTS SEGMENTO "W" (CHAMADO NO ARQUIVO DE LAYOUT FEBRABAN)"
nOPCAO := 7 "U_TPIMPRES() - INFORMACAO REFERENTE AO TIPO DE IMPRESSAO DO BOLETO NO MOMENTO DE GERAR O ARQUIVO CNAB DE RECEBIMENTO (CHAMADO NO ARQUIVO DE LAYOUT FEBRABAN)"
nOPCAO := 8 "U_RETINFO() - FUNÇÃO ONDE RETORNA A MENSAGEM PARA IMPRESSAO NO BOLETO NA GERAÇÃO DO CNAB DE RECEBIMENTO. (CHAMADO NO ARQUIVO DE LAYOUT FEBRABAN)"
nOPCAO := 9 "U_MODBORD() - FUNÇÃO PARA CADASTRAR NA TABELA SX5 OS MODELOS E TIPOS DE PAGAMENTO QUE FALTAM"
nOPCAO := 10"U_ConvLD() - FUNÇÃO PARA CONVERTER CÓDIGO DE BARRAS EM LINHA DIGITAVEL (CAMPOS E2_LINDIG E E2_CODBAR) (GATILHO DO CAMPO)"
nOPCAO := 11"U_CTADVFAV() - FUNÇÃO PARA TRATAR A CONTA E O DIGITO VERIFICADOR DO FAVORECIDO RETORNANDO DA SE2 OU SA2.

@author Leosanlim
@since 02/01/2019
@version 1.0
@return ${return}, ${return_description}
@type function
/*/
USER FUNCTION GTFIN038(nOPCAO,cDados)
*=====================================================================================================================================*
LOCAL cRet := ""

//INICIO VARIAVEIS DA FUNÇÃO U_PARBCO()
LOCAL cCodEmp := ""//SM0->M0_CODIGO//+"-"+
LOCAL cUnidade := ""//IF(cCodEmp == "99","D:\ASTAGE\CNAB\","\\SRVDCASTAGE01\E$\ASTAGE\CNAB\")
LOCAL cCorpCli := ""//IF(GETMV("MV_P_00122"),"CORP\","CLI\")
LOCAL cDiretorio := ""//ALLTRIM(cUnidade)+ALLTRIM(cCorpCli)+ALLTRIM(SM0->M0_CODIGO)+"\"+ALLTRIM(M->EE_CODIGO)+"\"+ALLTRIM(M->EE_CONTA)
LOCAL cMSG := ""

//FIM  VARIAVEIS DA FUNÇÃO U_PARBCO()\\
//INICIO VARIAVEIS DA FUNÇÃO U_ACCESST(cPergunt)
LOCAL cPergunt 
LOCAL cArqCfg := ""
LOCAL cArqEnv := ""//cValToChar(SM0->M0_CODIGO)+"_"+ DTOS(date()) + "_" + STRTRAN(TIME(), ":","") +"."+SEE->EE_EXTEN
LOCAL cBanco   := ""//IF(cPergunt == "AFI200",MV_PAR06,MV_PAR05)
LOCAL cAgencia := ""//IF(cPergunt == "AFI200",MV_PAR07,MV_PAR06)//IF(cPergunt == "AFI420",MV_PAR06,mv_agencia)
LOCAL cConta   := ""//IF(cPergunt == "AFI200",MV_PAR08,MV_PAR07)//IF(cPergunt == "AFI420",MV_PAR07,mv_cta)
LOCAL cSubCta  := ""//IF(cPergunt == "AFI200",MV_PAR09,MV_PAR08)//IF(cPergunt == "AFI420",MV_PAR08,mv_subcta)
LOCAL cOperac  := ""
LOCAL cArqCnab := ""
LOCAL cOper := ""

//FIM VARIAVEIS DA FUNÇÃO U_ACCESST(cPergunt)
//INICIO VARIAVEIS DA FUNÇÃO U_LAYCNAB()
LOCAL aArqLay := {}
LOCAL nHandle
LOCAL cTxto  := ""
LOCAL cMsgLayout := ""

//FIM VARIAVEIS DA FUNÇÃO U_LAYCNAB()
//INICIO VARIAVEIS DA FUNÇÃO U_INFOTRIB()
LOCAL cModPag    := ""//Posicione("SEA",1,xFilial("SEA")+SE2->E2_NUMBOR+SE2->E2_PREFIXO+SE2->E2_NUM+SE2->E2_PARCELA,"EA_MODELO")
LOCAL nOutEnt	 := 0
//FIM VARIAVEIS DA FUNÇÃO U_INFOTRIB()
//INICIO VARIAVEIS DA FUNÇÃO nOPCAO == 8 U_RETINFO()
LOCAL cVal //PARAMIXB[1]
//FIM VARIAVEIS DA FUNÇÃO nOPCAO == 8 U_RETINFO()
//INICIO VARIAVEIS DA FUNÇÃO U_MODBORD()
LOCAL aModelo := {}
LOCAL cMsgModBor :=""
//FIM VARIAVEIS DA FUNÇÃO U_MODBORD()
//INICIO VARIAVEIS DA FUNÇÃO U_ConvLD()
local cStr := ""
//FIM VARIAVEIS DA FUNÇÃO U_ConvLD()


/*************************
INICIO DAS OPÇÕES 
*************************/
DO CASE
	CASE nOPCAO == 1 //U_NOEMP()
		cRet := (IF(AT("/",STRTRAN(ALLTRIM(SM0->M0_NOME)," ","/"))==0,ALLTRIM(SM0->M0_NOME),SUBSTR(STRTRAN(ALLTRIM(SM0->M0_NOME)," ","/"),1, AT("/",STRTRAN(ALLTRIM(SM0->M0_NOME)," ","/"))-1)))


	CASE nOPCAO == 2 //U_PARBCO()
		cCodEmp := SM0->M0_CODIGO//+"-"+
		cUnidade := IF(cCodEmp == "99","D:\ASTAGE\",ALLTRIM(SUPERGETMV("MV_P_00132",.F.,"\\SRVDCASTAGE01\E$\FINNET\")))//IF(cCodEmp == "99","D:\ASTAGE\CNAB\","\\SRVDCASTAGE01\E$\ASTAGE\CNAB\")     	//CAS - 04/11/2019 Ajustado o caminho para \\SRVDCAPP04\e$\FINNET\
		cCorpCli := IF(SUPERGETMV("MV_P_00122",.F.,.F.),"CORP\","CLI\")
		//cDiretorio := ALLTRIM(cUnidade)+"CNAB\"+ALLTRIM(cCorpCli)+ALLTRIM(SM0->M0_CODIGO)+"\"+ALLTRIM(M->EE_CODIGO)+"\"+ALLTRIM(M->EE_CONTA)		  
		//cDiretorio := ALLTRIM(cUnidade)+"CNAB\"+ALLTRIM(cCorpCli)+ALLTRIM(SM0->M0_CODIGO)+"\"+ALLTRIM(M->EE_CODIGO)+"\"+AllTrim(StrTran(StrTran(M->EE_CONTA,"-","" ),".","" ))+AllTrim(SEE->EE_DVCTA)	//CAS - 21/08/2019 Adicionado o campo SEE->EE_DVCTA
		  cDiretorio := ALLTRIM(cUnidade)+"O0055FINNET\ENTRADA\"																																		//CAS - 04/11/2019 O0055FINNET\SAIDA\
		cMSG +="<center><h1><font color='#ff0000'>Atenção!</font></h1></center><br>"
		cMSG +="Ao selecinar que o banco ira utilizar o Padrao FEBRABAN para trafegar os arquivos CNAB"  																								//CAS - 04/11/2019 Alterado de Accesstage para FEBRABAN 
		cMSG +=", o sistema ira configurar os diretórios para gerar os arquivos e completar o preenchimento dos parametros.<br>"
		cMSG +=" <b>Você confirma a utilização desse parametro?</b>"

		IF M->EE_P_ACCES == "1"
			
			IF MSGYESNO(cMSG)			
				//ABA CADASTRAIS (UFINA130.PRW)
				M->EE_ULTDSK  := IF(EMPTY(M->EE_ULTDSK),"000000",M->EE_ULTDSK)
				M->EE_EXTEN   := "TXT"
				M->EE_FAXINI  := IF(EMPTY(M->EE_FAXINI),"000000000001",M->EE_FAXINI)
				M->EE_FAXFIM  := IF(EMPTY(M->EE_FAXFIM),"999999999999",M->EE_FAXFIM)
				M->EE_NRBYTES := 240
				M->EE_TIPODAT := 4
				//ABA RETORNO AUTOMÁTICO (UFINA130.PRW)
				M->EE_RETAUT := "3"
				M->EE_AGLCTB := "3"

				M->EE_CFGPAG := "FEBRABN.2PR"
				M->EE_CFGREC := "FEBRABN.2RR"

				M->EE_DIRPAG := cDiretorio  			//CAS - 04/11/2019
				M->EE_BKPPAG := cDiretorio+"BACKUP\"	//CAS - 04/11/2019
				M->EE_DIRREC := cDiretorio  			//CAS - 04/11/2019
				M->EE_BKPREC := cDiretorio+"BACKUP\"	//CAS - 04/11/2019

				M->EE_CNABPG := "2"
				M->EE_CNABRC := "2"	
			ELSE	
				M->EE_P_ACCES := "2"// M->EE_P_ACCES
			ENDIF
		ELSE
			M->EE_RETAUT := "0"
		ENDIF 

	
	CASE nOPCAO == 3 //U_ACCESST(cPergunt)
		cPergunt := cDados
		cArqEnv := cValToChar(SM0->M0_CODIGO)+"_"+ DTOS(date()) + "_" + STRTRAN(TIME(), ":","") +"."+SEE->EE_EXTEN
		cBanco   := IF(cPergunt == "AFI200",MV_PAR06,MV_PAR05)
		cAgencia := IF(cPergunt == "AFI200",MV_PAR07,MV_PAR06)//IF(cPergunt == "AFI420",MV_PAR06,mv_agencia)
		cConta   := IF(cPergunt == "AFI200",MV_PAR08,MV_PAR07)//IF(cPergunt == "AFI420",MV_PAR07,mv_cta)
		cSubCta  := IF(cPergunt == "AFI200",MV_PAR09,MV_PAR08)//IF(cPergunt == "AFI420",MV_PAR08,mv_subcta)
		
		//VERIFICAR SE EXISTE O LAYOUT DA FEBRABAN NO SYSTEM, CASO CONTRARIO DEVE CHAMAR UMA FUNÇÃO PARA CRIAR ESSE ARQUIVO.
		IF !FILE("FEBRABAN.2PE") .OR. !FILE("FEBRABAN.2RE") .OR. !FILE("FEBRABAN.2PR") .OR. !FILE("FEBRABAN.2RR")
			MsgAlert("Arquivos de layout não foram encontrados no driver e na pasta, e serão criados!")
			U_GTFIN038(4,'')//FUNÇÃO PARA CRIAR OS ARQUIVOS DE LAYOUT QUE NÃO EXISTIREM.
		ENDIF

		/////////////////////////////////////////
		//AUTO PREENCHENDO OS PERGUNTES PARA ENVIO/RETORNO CNAB
		/////////////////////////////////////////
		DO CASE
			
			//PERGUNTE REMESSA A PAGAR - AFI420
			CASE cPergunt == "AFI420"
				cArqCfg := "FEBRABAN.2PE"
				cOperac := "01"
				cOper := "PE"

			//PERGUNTE RETORNO A PAGAR - AFI430
			CASE cPergunt == "AFI430"
				If ISINCALLSTACK("U_UFINA473")		//CAS - 18/01/2021 Ajuste para Extrato - Conciliação Automática
					cArqCfg := "FEBRABAN.REC"
				Else	
					cArqCfg := "FEBRABAN.2PR"
				EndIf
				cOperac := "02"
				cOper := "PR"

			//PERTUNTE REMESSA A RECEBER - AFI150
			CASE cPergunt == "AFI150"
				cArqCfg := "FEBRABAN.2RE"
				cOperac := "04"
				cOper := "RE"

			//PERGUNTE RETORNO A RECEBER - AFI200
			CASE cPergunt == "AFI200"
				cArqCfg := "FEBRABAN.2RR"
				cOperac := "05"
				cOper := "RR"
		ENDCASE
		
		U_GTFIN038(9,'')//FUNÇÃO PARA CADASTRAR OS MODELOS DE BORDERO FALTANTES.
		
		IF !EMPTY(cSubCta) .AND. !EMPTY(cConta)
			DbSelectArea("SEE")
			SEE->(DbSetOrder(1))
			IF SEE->(dbSeek(xFilial("SEE")+cBanco+cAgencia+cConta+cSubCta))
				cArqCnab := cValToChar(SM0->M0_CODIGO)+"_"+cOper+"_"+ DTOS(date()) + "_" + STRTRAN(TIME(), ":","") +"."+SEE->EE_EXTEN // novo nome do arquivo de saída.
				IF SEE->EE_P_ACCES == '1'
				DbSelectArea("Z0D")
				
				Z0D->(DbSetOrder(2))
				IF Z0D->(dbSeek(xFilial("Z0D")+cBanco+cAgencia+cConta+cSubCta+cOperac))
					
					//PERGUNTE RETORNO A RECEBER - AFI200
					IF cPergunt == "AFI200"
						//MV_PAR04 := AllTrim(Z0D->Z0D_DIR)+AllTrim(cArqCnab)
						MV_PAR05 := cArqCfg
						MV_PAR12 := 2

					//PERGUNTE RETORNO A PAGAR - AFI430
					ELSEIF cPergunt == "AFI430"
						//MV_PAR03 := AllTrim(Z0D->Z0D_DIR)+AllTrim(cArqCnab)
						MV_PAR04 := cArqCfg
						MV_PAR10 := 2

					//PERGUNTE REMESSA A PAGAR - AFI420 OU PERTUNTE REMESSA A RECEBER - AFI150
					ELSE
						MV_PAR03 := cArqCfg
						MV_PAR04 := AllTrim(Z0D->Z0D_DIR)+AllTrim(cArqCnab)
						MV_PAR09 := 2
					ENDIF
					
				ENDIF
				Z0D->(dbCloseArea())
				ENDIF

			ENDIF
			SEE->(dbCloseArea())
		ENDIF

	CASE nOPCAO == 4 //U_LAYCNAB()
		//ARQUIVOS DE LAYOUT DE DEVEM EXISTIR
		AADD(aArqLay,"FEBRABAN.2PE")//CNAB REMESSA A PAGAR
		AADD(aArqLay,"FEBRABAN.2PR")//CNAB RETORNO A PAGAR
		AADD(aArqLay,"FEBRABAN.2RE")//CNAB REMESSA A RECEBER
		AADD(aArqLay,"FEBRABAN.2RR")//CNAB RETORNO A RECEBER

		FOR c := 1 to LEN(aArqLay)
			//LAYOUT CNAB REMESSA A PAGAR
			IF aArqLay[c] == "FEBRABAN.2PE"
				//SE O ARQUIVO NÃO EXISTIR CRIA
				IF !FILE(aArqLay[c])
					nHandle := FCreate(aArqLay[c])
					If nHandle < 0
						MsgAlert("Erro durante criação do arquivo ("+aArqLay[c]+").")
					Else
						//
						cTxto  := ""
						//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
						// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! IMPORTANTE !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
						//³O ARQUIVO DEVE SER GERADO COM 500 POSIÇÕES POR ISSO DEVE MANTER OS ESPAÇOS                                         ³
						//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
						cTxto +=PADR("10H HEADER ARQUDIVO                .T.",500)+ ENTER
						cTxto +=PADR("10T TRAILLER PRINCIPAL            .T.",500)+ ENTER
						cTxto +=PADR("11D1SEGMENTO A                    SEA->EA_MODELO$'01/02/03/04/05/07/10/41/43'",500)+ ENTER
						cTxto +=PADR("11D2SEGMENTO B                    SEA->EA_MODELO$'01/02/03/04/05/07/10/41/43'",500)+ ENTER
						cTxto +=PADR("11D3SEGMENTO C                    .F.",500)+ ENTER
						cTxto +=PADR("11D4SEGMENTO J                    SEA->EA_MODELO$'30/31'",500)+ ENTER
						cTxto +=PADR("11D5SEGMENTO O                    SEA->EA_MODELO$'11/13/19/23/28/35'",500)+ ENTER
						cTxto +=PADR("11D6SEGMENTO N                    SEA->EA_MODELO$'16/17/18/21/22/25/26/27/29'",500)+ ENTER
						cTxto +=PADR("11D7SEGMENTO J-52                 IIF(SEA->EA_MODELO $ '30/31',.T.,.F.)",500)+ ENTER						//CAS - 24/06/2020 Ajustado Leiaute P J-52, era SEA->EA_MODELO$'31' .AND. SEE->EE_CODIGO$'341/376'
						//cTxto +=PADR("11D8SEGMENTO W                    SE2->E2_P_TRIB$'01' .AND. SEA->EA_MODELO$'35'",500)+ ENTER
						cTxto +=PADR("11D8SEGMENTO W                    .F.",500)+ ENTER
						cTxto +=PADR("11H HEADER LOTE - SEG. A/B/J/N/O  .T.",500)+ ENTER
						cTxto +=PADR("11T TRAILLER LOTE - SEG. A/B/J    SEA->EA_MODELO$'01/02/03/04/05/06/07/10/30/31/41/43'",500)+ ENTER   
						cTxto +=PADR("12T TRAILLER LOTE - SEG. O/N      SEA->EA_MODELO$'11/13/16/17/18/19/21/22/23/25/26/27/28/29/35'",500)+ ENTER
						cTxto +=PADR("21T BCO COMPENSACAO0010030SEE->EE_CODIGO",500)+ ENTER
						cTxto +=PADR("21T LOTE SERVICO   0040070STRZERO(NLOTCNAB2,4)",500)+ ENTER
						cTxto +=PADR("21T REGISTRO       0080080'5'",500)+ ENTER
						cTxto +=PADR("21T EXCLUS FEBRABAN0090170SPACE(9)",500)+ ENTER
						cTxto +=PADR("21T QTDE REG.      0180230STRZERO(F420LINLOT(),6)",500)+ ENTER
						cTxto +=PADR("21T VLR CREDITO    0240412STRZERO(NSOMAVLLOTE*100,18)",500)+ ENTER
						cTxto +=PADR("21T ZEROS          0420595STRZERO(0,18)",500)+ ENTER
						cTxto +=PADR("21T AVISO DEBITO   0600650SPACE(6)",500)+ ENTER
						cTxto +=PADR("21T EXCLUS FEBRABAN0662300SPACE(165)",500)+ ENTER
						cTxto +=PADR("21T OCORRENCIA     2312400SPACE(10)",500)+ ENTER
						cTxto +=PADR("22T COD BCO        0010030SEE->EE_CODIGO",500)+ ENTER
						cTxto +=PADR("22T LOTE SERVICO   0040070STRZERO(NLOTCNAB2,4)",500)+ ENTER
						cTxto +=PADR("22T REGISTRO       0080080'5'",500)+ ENTER
						cTxto +=PADR("22T EXCLUS FEBRABAN0090170SPACE(9)",500)+ ENTER
						cTxto +=PADR("22T QTDE REG.      0180230STRZERO(F420LINLOT(),6)",500)+ ENTER
						cTxto +=PADR("22T VLR CREDITO    0240412STRZERO(NSOMAVLLOTE*100,18)",500)+ ENTER
						cTxto +=PADR("22T COMPLE REG.    0422300SPACE(189)",500)+ ENTER
						cTxto +=PADR("22T OCORRENCIA     2312400SPACE(10)",500)+ ENTER
						cTxto +=PADR("23T COD BANCO      0010030SEE->EE_CODIGO",500)+ ENTER
						cTxto +=PADR("23T COD LOTE       0040070STRZERO(NLOTCNAB2,4)",500)+ ENTER
						cTxto +=PADR("23T TIPO REGISTRO  0080080'5'",500)+ ENTER
						cTxto +=PADR("23T BRANCOS        0090170",500)+ ENTER
						cTxto +=PADR("23T TOTAL REGISTROS0180230NTOTCNAB2+2",500)+ ENTER
						cTxto +=PADR("23T TOTAL VAL TRIB 0240370SOMAVALOR()",500)+ ENTER
						cTxto +=PADR("23T TOTAL OUT ENTID0380510",500)+ ENTER
						cTxto +=PADR("23T TOTAL ATUAL MON0520650",500)+ ENTER
						cTxto +=PADR("23T TOTAL VAL ARREC0660790",500)+ ENTER
						cTxto +=PADR("23T BRANCOS        0802300",500)+ ENTER
						cTxto +=PADR("23T OCORRENCIAS    2312400",500)+ ENTER
						cTxto +=PADR("21H COD BCO        0010030SEE->EE_CODIGO",500)+ ENTER
						cTxto +=PADR("21H LOTE SERVICO   0040070STRZERO(NLOTCNAB2,4)",500)+ ENTER
						cTxto +=PADR("21H REG HEADER LOTE0080080'1'",500)+ ENTER
						cTxto +=PADR("21H TIPO OPERACAO  0090090'C'",500)+ ENTER
						cTxto +=PADR("21H TIPO SERVICO   0100110SEA->EA_TIPOPAG",500)+ ENTER
						cTxto +=PADR("21H FORMA LCTO     0120130SEA->EA_MODELO",500)+ ENTER			
						cTxto +=PADR("21H VERSAO LAYOUT  0140160'046'",500)+ ENTER
						cTxto +=PADR("21H EXCLUS FEBRABAN0170170SPACE(1)",500)+ ENTER
						cTxto +=PADR("21H INSCR. TIPO    0180180'2'",500)+ ENTER
						cTxto +=PADR("21H INSCR. NUMERO  0190320PADL(ALLTRIM(SM0->M0_CGC),14,'0')",500)+ ENTER
						cTxto +=PADR("21H CONVENIO       0330520SUBSTR(SEE->EE_CODEMP,1,20)",500)+ ENTER
						cTxto +=PADR("21H AGENCIA DA CTA 0530570STRZERO(VAL(SEE->EE_AGENCIA),5)",500)+ ENTER
						cTxto +=PADR("21H DV_AGENCIA     0580580SUBSTR(SEE->EE_DVAGE,1,1)",500)+ ENTER
						cTxto +=PADR("21H CTA CORRENTE   0590700IIF(SEE->EE_CODIGO$'745',STRZERO(VAL(SEE->EE_CONTA),12),IF(EMPTY(SEE->EE_DVCTA),LEFT(STRZERO(VAL(SEE->EE_CONTA),13),12),STRZERO(VAL(SEE->EE_CONTA),12)))",500)+ ENTER
						cTxto +=PADR("21H DV_CONTA       0710710IIF(EMPTY(SEE->EE_DVCTA),RIGHT(ALLTRIM(SEE->EE_CONTA),1),SEE->EE_DVCTA)",500)+ ENTER                   											//CAS - 28/12/2020 Ajustado Leiaute de SUBSTR(SEE->EE_DVCTA,1,1) para IIF(EMPTY(SEE->EE_DVCTA),RIGHT(ALLTRIM(SEE->EE_CONTA),1),SEE->EE_DVCTA)
						cTxto +=PADR("21H DAC DA AG./CTA 0720720IIF(SEE->EE_CODIGO$'745',' ',RIGHT(ALLTRIM(SEE->EE_CONTA+SEE->EE_DVCTA),1))",500)+ ENTER
						cTxto +=PADR("21H NOME EMPRESA   0731020SUBSTR(FwCutOff(ALLTRIM(SM0->M0_NOME),.T.),1,30)",500)+ ENTER
						cTxto +=PADR("21H MENSAGEM       1031420SPACE(40)",500)+ ENTER
						cTxto +=PADR("21H LOGRADOURO     1431720SUBSTR(SM0->M0_ENDCOB, 1, AT(',', SM0->M0_ENDCOB) - 1)",500)+ ENTER
						cTxto +=PADR("21H NUMERO         1731770SUBSTR(SM0->M0_ENDCOB, AT(',', SM0->M0_ENDCOB) + 2, 5)",500)+ ENTER
						cTxto +=PADR("21H COMPLEMENTO    1781920SUBSTR(SM0->M0_COMPCOB,1,15)",500)+ ENTER
						cTxto +=PADR("21H CIDADE         1932120SUBSTR(SM0->M0_CIDCOB,1,20)",500)+ ENTER
						cTxto +=PADR("21H CEP            2132170SUBSTR(SM0->M0_CEPCOB,1,5)",500)+ ENTER
						cTxto +=PADR("21H COMP CEP       2182200SUBSTR(SM0->M0_CEPCOB,6,3)",500)+ ENTER
						cTxto +=PADR("21H ESTADO         2212220SUBSTR(SM0->M0_ESTCOB ,1,2)",500)+ ENTER
						cTxto +=PADR("21H FORMA PAGTO    2232240SPACE(2)",500)+ ENTER
						cTxto +=PADR("21H EXCLUS FEBRABAN2252300SPACE(6)",500)+ ENTER
						cTxto +=PADR("21H COD OCORR RETOR2312400SPACE(10)",500)+ ENTER
						cTxto +=PADR("20T BCO COMPENSACAO0010030SEE->EE_CODIGO",500)+ ENTER
						cTxto +=PADR("20T LOTE DE SERVICO0040070'9999'",500)+ ENTER
						cTxto +=PADR("20T REG TRAILER ARQ0080080'9'",500)+ ENTER
						cTxto +=PADR("20T FILLER         0090170SPACE(9)",500)+ ENTER
						cTxto +=PADR("20T QTD LOTES      0180230STRZERO(NLOTCNAB2,6)",500)+ ENTER
						cTxto +=PADR("20T QTD REGISTRO   0240290FNLINCNAB2()",500)+ ENTER
						cTxto +=PADR("20T QTD CTA CONCIL 0300350STRZERO(0,6)",500)+ ENTER
						cTxto +=PADR("20T EXCLUS FEBRABAN0362400SPACE(205)",500)+ ENTER
						cTxto +=PADR("20H COD BCO        0010030SEE->EE_CODIGO",500)+ ENTER
						cTxto +=PADR("20H LOTE SERVICO   0040070'0000'",500)+ ENTER
						cTxto +=PADR("20H REG.HEADER ARQ.0080080'0'",500)+ ENTER
						cTxto +=PADR("20H FILLER         0090140SPACE(06)",500)+ ENTER
						cTxto +=PADR("20H VERS.LAYOUT ARQ0150170SPACE(03)",500)+ ENTER
						cTxto +=PADR("20H TIPO INSCRICAO 0180180'2'",500)+ ENTER
						cTxto +=PADR("20H NUM. INSCRICAO 0190320PADL(ALLTRIM(SM0->M0_CGC),14,'0')",500)+ ENTER
						cTxto +=PADR("20H CONVENIO       0330520SUBSTR(SEE->EE_CODEMP,1,20)",500)+ ENTER
						cTxto +=PADR("20H AGENCIA        0530570STRZERO(VAL(SEE->EE_AGENCIA),5)",500)+ ENTER
						cTxto +=PADR("20H DV_AGENCIA     0580580SUBSTR(SEE->EE_DVAGE,1,1)",500)+ ENTER
						cTxto +=PADR("20H CONTA CORRENTE 0590700IIF(SEE->EE_CODIGO$'745',STRZERO(VAL(SEE->EE_CONTA),12),IF(EMPTY(SEE->EE_DVCTA),LEFT(STRZERO(VAL(SEE->EE_CONTA),13),12),STRZERO(VAL(SEE->EE_CONTA),12)))",500)+ ENTER
						cTxto +=PADR("20H DV_CONTA       0710710IIF(EMPTY(SEE->EE_DVCTA),RIGHT(ALLTRIM(SEE->EE_CONTA),1),SEE->EE_DVCTA)",500)+ ENTER           //CAS - 28/12/2020 Ajustado Leiaute de SUBSTR(SEE->EE_DVCTA,1,1) para IIF(EMPTY(SEE->EE_DVCTA),RIGHT(ALLTRIM(SEE->EE_CONTA),1),SEE->EE_DVCTA)
						cTxto +=PADR("20H DIGITO DA CTA  0720720IIF(SEE->EE_CODIGO$'745',' ',RIGHT(ALLTRIM(SEE->EE_CONTA+SEE->EE_DVCTA),1))",500)+ ENTER
						cTxto +=PADR("20H NOME DA EMPRESA0731020SUBSTR(FwCutOff(ALLTRIM(SM0->M0_NOME),.T.),1,30)",500)+ ENTER
						cTxto +=PADR("20H NOME DO BANCO  1031320SUBSTR(SA6->A6_NOME,1,30)",500)+ ENTER
						cTxto +=PADR("20H EXCLU FEBRABRAN1331420SPACE(10)",500)+ ENTER
						cTxto +=PADR("20H REMESSA        1431430'1'",500)+ ENTER
						cTxto +=PADR("20H DT.GERACAO     1441510GRAVADATA(DDATABASE,.F.,5)",500)+ ENTER
						cTxto +=PADR("20H HR.GERACAO     1521570STRTRAN(TIME(),':')",500)+ ENTER
						cTxto +=PADR("20H SEQUENCIA (NSA)1581630STRZERO(VAL(SEE->EE_ULTDSK)+1,6)",500)+ ENTER
						cTxto +=PADR("20H LAYOUT         1641660'103'",500)+ ENTER
						cTxto +=PADR("20H DENSIDADE GRAV.1671710'00000'",500)+ ENTER
						cTxto +=PADR("20H RESERVADO BCO  1721910SPACE(20)",500)+ ENTER
						cTxto +=PADR("20H RESERVADO EMP  1922110SPACE(20)",500)+ ENTER
						cTxto +=PADR("20H EXCLU FEBRABRAN2122400SPACE(29)",500)+ ENTER
						cTxto +=PADR("21D3BCO COMPENSACAO0010030SEE->EE_CODIGO",500)+ ENTER
						cTxto +=PADR("21D3LOTE SERVICO   0040070STRZERO(NLOTCNAB2,4)",500)+ ENTER
						cTxto +=PADR("21D3RG.DETALHE LOTE0080080'3'",500)+ ENTER
						cTxto +=PADR("21D3SEQ.REG.LOTE   0090130STRZERO(F420SEQLOT(),5)",500)+ ENTER
						cTxto +=PADR("21D3COD.SEQ.REG.DET0140140'C'",500)+ ENTER
						cTxto +=PADR("21D3EXCLUSIVO FEBRA0150170SPACE(3)",500)+ ENTER
						cTxto +=PADR("21D3VL IR          0180322STRZERO(SE2->E2_IRRF,15)",500)+ ENTER
						cTxto +=PADR("21D3VL ISS         0330472STRZERO(SE2->E2_ISS,15)",500)+ ENTER
						cTxto +=PADR("21D3VL IOF         0480622STRZERO(0,15)",500)+ ENTER
						cTxto +=PADR("21D3VL OUT DEDUCOES0630772STRZERO(0,15)",500)+ ENTER
						cTxto +=PADR("21D3VL OUT ACRESCIM0780922STRZERO(0,15)",500)+ ENTER
						cTxto +=PADR("21D3AG FAVOR       0930970STRZERO(VAL(SA2->A2_AGENCIA),5)",500)+ ENTER
						cTxto +=PADR("21D3DV AG FAVOR    0980980SPACE(1)",500)+ ENTER
						cTxto +=PADR("21D3NUM CTA FAVOR  0991100IIF(AT('-',SA2->A2_NUMCON)>0,STRZERO(VAL(SUBSTR(SA2->A2_NUMCON,1,AT('-',SA2->A2_NUMCON)-1)),12),STRZERO(VAL(SUBSTR(ALLTRIM(SA2->A2_NUMCON),1,LEN(ALLTRIM(SA2->A2_NUMCON))-1 )),12))",500)+ ENTER
						cTxto +=PADR("21D3DV CTA FAVOR   1111110IIF(AT('-',SA2->A2_NUMCON)>0,SUBSTR(SA2->A2_NUMCON,AT('-',SA2->A2_NUMCON)+1,1),RIGHT(ALLTRIM(SA2->A2_NUMCON),1))",500)+ ENTER
						cTxto +=PADR("21D3DV AG/CTA FAVOR1121120SPACE(1)",500)+ ENTER
						cTxto +=PADR("21D3VL INSS        1131272STRZERO(SE2->E2_INSS,15)",500)+ ENTER
						cTxto +=PADR("21D3CTA PAG CREDITA1281470STRZERO(0,20)",500)+ ENTER
						cTxto +=PADR("21D3EXCLUSIVO FEBRA1482400SPACE(93)",500)+ ENTER
						cTxto +=PADR("21D2BCO COMPENSACAO0010030STRZERO(VAL(SEE->EE_CODIGO),3)",500)+ ENTER
						cTxto +=PADR("21D2LOTE SERVICO   0040070STRZERO(NLOTCNAB2,4)",500)+ ENTER
						cTxto +=PADR("21D2RG.DETALHE LOTE0080080'3'",500)+ ENTER
						cTxto +=PADR("21D2SEQ.REG.LOTE   0090130STRZERO(F420SEQLOT(),5)",500)+ ENTER
						cTxto +=PADR("21D2COD.SEQ.REG.DET0140140'B'",500)+ ENTER
						cTxto +=PADR("21D2EXCLUSIVO FEBRA0150170SPACE(3)",500)+ ENTER
						cTxto +=PADR("21D2TP INSC FAVOR  0180180IIF(EMPTY(SE2->E2_P_TIPO),IF(SA2->A2_TIPO='J','2',IF(SA2->A2_TIPO='F','1','9')),IF(SE2->E2_P_TIPO='J','2',IF(SE2->E2_P_TIPO='F','1','9')))",500)+ ENTER
						cTxto +=PADR("21D2NUM INSC FAVOR 0190320PADL(ALLTRIM(IIF(EMPTY(SE2->E2_P_CGCBN),SA2->A2_CGC,SE2->E2_P_CGCBN)),14,'0')",500)+ ENTER
						cTxto +=PADR("21D2LOGRADOURO     0330620SUBSTR(SA2->A2_END,1,30)",500)+ ENTER
						cTxto +=PADR("21D2NÚMERO         0630670STRZERO(0,5)",500)+ ENTER
						cTxto +=PADR("21D2COMPLEMENTO    0680820SUBSTR(SA2->A2_ENDCOMP,1,15)",500)+ ENTER
						cTxto +=PADR("21D2BAIRRO         0830970SUBSTR(SA2->A2_BAIRRO,1,15)",500)+ ENTER
						cTxto +=PADR("21D2CIDADE         0981170SUBSTR(SA2->A2_MUN,1,20)",500)+ ENTER
						cTxto +=PADR("21D2CEP            1181220PADL(ALLTRIM(SA2->A2_CEP),5,'0')",500)+ ENTER
						cTxto +=PADR("21D2COMP CEP       1231250SUBSTR(SA2->A2_CEP,6)",500)+ ENTER
						cTxto +=PADR("21D2ESTADO         1261270SA2->A2_EST",500)+ ENTER
						cTxto +=PADR("21D2DT VENCTO      1281350GRAVADATA(SE2->E2_VENCREA,.F.,5)",500)+ ENTER
						cTxto +=PADR("21D2VL DOCTO       1361502STRZERO(SE2->E2_VLCRUZ*100,15)",500)+ ENTER
						cTxto +=PADR("21D2VL ABATIMENTO  1511652STRZERO(0,15)",500)+ ENTER
						cTxto +=PADR("21D2VL DESCONTO    1661802STRZERO(SE2->E2_DESCONT,15)",500)+ ENTER
						cTxto +=PADR("21D2VL MORA        1811952STRZERO(SE2->E2_JUROS,15)",500)+ ENTER
						cTxto +=PADR("21D2VL MULTA       1962102STRZERO(SE2->E2_MULTA,15)",500)+ ENTER
						cTxto +=PADR("21D2COD/DOC FAVOR  2112250SPACE(15)",500)+ ENTER
						cTxto +=PADR("21D2AVISO AO FAVOR 2262260'0'",500)+ ENTER
						cTxto +=PADR("21D2EXCLUSIVO SIAPE2272320STRZERO(0,6)",500)+ ENTER
						cTxto +=PADR("21D2COD ISPB       2332400STRZERO(0,8)",500)+ ENTER
						cTxto +=PADR("21D4BCO COMPENSACAO0010030SEE->EE_CODIGO",500)+ ENTER
						cTxto +=PADR("21D4LOTE SERVICO   0040070STRZERO(NLOTCNAB2,4)",500)+ ENTER
						cTxto +=PADR("21D4REG.DET. LOTE  0080080'3'",500)+ ENTER
						cTxto +=PADR("21D4SEQ REG LOTE   0090130STRZERO(F420SEQLOT(),5)",500)+ ENTER
						cTxto +=PADR("21D4SEQ.REG.DET    0140140'J'",500)+ ENTER
						cTxto +=PADR("21D4TIPO DE MOV.   0150170PADL(AllTrim(SE2->E2_P_TPMV+SE2->E2_P_INSMV),3,'0')",500)+ ENTER
						cTxto +=PADR("21D4COD BARRRAS    0180610SUBSTR(SE2->E2_CODBAR,1,44)",500)+ ENTER
						cTxto +=PADR("21D4NOME BENEFICIAR0620910LEFT(IIF(EMPTY(SE2->E2_P_NOMBN),FwCutOff(ALLTRIM(SA2->A2_NOME),.T.),FwCutOff(ALLTRIM(SE2->E2_P_NOMBN),.T.)),30)",500)+ ENTER
						cTxto +=PADR("21D4DT VENCTO      0920990GRAVADATA(SE2->E2_VENCREA,.F.,5)",500)+ ENTER
						cTxto +=PADR("21D4VALOR DO TITULO1001142STRZERO(SE2->E2_SALDO*100,15)",500)+ ENTER
						cTxto +=PADR("21D4DESCONTO       1151292STRZERO(INT(SE2->E2_DECRESC*100),15)",500)+ ENTER
						cTxto +=PADR("21D4ACRESCIMO      1301442STRZERO(INT(SE2->E2_ACRESC*100),15)",500)+ ENTER
						cTxto +=PADR("21D4DT EFET.DO PAG.1451520GRAVADATA(SE2->E2_VENCREA,.F.,5)",500)+ ENTER
						cTxto +=PADR("21D4VAL.EFET.DO PAG1531672STRZERO(((SE2->E2_SALDO+SE2->E2_ACRESC)-SE2->E2_DECRESC)*100,15)",500)+ ENTER
						cTxto +=PADR("21D4QTD MOEDA      1681825STRZERO(0,15)",500)+ ENTER
						cTxto +=PADR("21D4SEU NUMERO     1832020SE2->E2_IDCNAB",500)+ ENTER
						cTxto +=PADR("21D4NOSSO NUMERO   2032220SPACE(20)",500)+ ENTER
						cTxto +=PADR("21D4CODIGO DE MOEDA2232240'09'",500)+ ENTER
						cTxto +=PADR("21D4EXCLUS FEBRABAN2252300SPACE(6)",500)+ ENTER
						cTxto +=PADR("21D4OCORRENCIA     2312400SPACE(10)",500)+ ENTER
						cTxto +=PADR("21D5COD BANCO      0010030SEE->EE_CODIGO",500)+ ENTER
						cTxto +=PADR("21D5COD LOTE       0040070STRZERO(NLOTCNAB2,4)",500)+ ENTER
						cTxto +=PADR("21D5TIPO REGISTRO  0080080'3'",500)+ ENTER
						cTxto +=PADR("21D5NUM REGISTRO   0090130STRZERO(F420SEQLOT(),5)",500)+ ENTER
						cTxto +=PADR("21D5SEGMENTO       0140140'O'",500)+ ENTER
						cTxto +=PADR("21D5TIPO MOVIMENTO 0150170PADL(AllTrim(SE2->E2_P_TPMV+SE2->E2_P_INSMV),3,'0')",500)+ ENTER
						cTxto +=PADR("21D5CODIGO BARRAS  0180610SUBSTR(SE2->E2_CODBAR,1,44)",500)+ ENTER
						cTxto +=PADR("21D5NOME CONCESSION0620910LEFT(IIF(EMPTY(SE2->E2_P_NOMBN),FwCutOff(ALLTRIM(SA2->A2_NOME),.T.),FwCutOff(ALLTRIM(SE2->E2_P_NOMBN),.T.)),30)",500)+ ENTER
						cTxto +=PADR("21D5DATA VENCTO    0920990GRAVADATA(SE2->E2_VENCTO,.F.,5)",500)+ ENTER												//CAS - 24/06/2020 Ajustado Leiaute para GRAVADATA(SE2->E2_VENCTO,.F.,5)
						cTxto +=PADR("21D5DATA PAGTO     1001070GRAVADATA(SE2->E2_VENCREA,.F.,5)",500)+ ENTER												//CAS - 24/06/2020 Ajustado Leiaute para GRAVADATA(SE2->E2_VENCREA,.F.,5)
						cTxto +=PADR("21D5VALOR PAGTO    1081222STRZERO(((SE2->E2_SALDO+SE2->E2_ACRESC)-SE2->E2_DECRESC)*100,15)",500)+ ENTER
						cTxto +=PADR("21D5SEU NUMERO     1231420SE2->E2_IDCNAB",500)+ ENTER
						cTxto +=PADR("21D5NOSSO NUMERO   1431620SPACE(20)",500)+ ENTER
						cTxto +=PADR("21D5EXCLUS FEBRABAN1632300SPACE(68)",500)+ ENTER
						cTxto +=PADR("21D5OCORRENCIA     2312400SPACE(10)",500)+ ENTER
						cTxto +=PADR("21D1BCO COMPENSACAO0010030STRZERO(VAL(SEE->EE_CODIGO),3)",500)+ ENTER
						cTxto +=PADR("21D1LOTE SERVICO   0040070STRZERO(NLOTCNAB2,4)",500)+ ENTER
						cTxto +=PADR("21D1RG.DETALHE LOTE0080080'3'",500)+ ENTER
						cTxto +=PADR("21D1SEQ.REG.LOTE   0090130STRZERO(F420SEQLOT(),5)",500)+ ENTER
						cTxto +=PADR("21D1COD.SEQ.REG.DET0140140'A'",500)+ ENTER
						cTxto +=PADR("21D1TIPO DE MOV.   0150170PADL(AllTrim(SE2->E2_P_TPMV+SE2->E2_P_INSMV),3,'0')",500)+ ENTER
						cTxto +=PADR("21D1CAMARA CENTRAL 0180200STRZERO(IF(SEA->EA_MODELO='03',700,IF(SEA->EA_MODELO$'41/43',018,0)) ,3)",500)+ ENTER
						cTxto +=PADR("21D1COD BCO FAVOR  0210230PADL(IIF(EMPTY(SE2->E2_FORBCO),SA2->A2_BANCO,SE2->E2_FORBCO) ,3,'0')",500)+ ENTER
						cTxto +=PADR("21D1AGENCIA FAVOR  0240280STRZERO(IIF(EMPTY(SE2->E2_FORAGE),VAL(SA2->A2_AGENCIA),VAL(SE2->E2_FORAGE)),5)",500)+ ENTER
						cTxto +=PADR("21D1DV_AGENCIA     0290290SUBSTR(IIF(EMPTY(SE2->E2_FAGEDV),SA2->A2_DVAGE,SE2->E2_FAGEDV),1,1)",500)+ ENTER    		//CAS - 24/06/2020 Ajustado Leiaute de SPACE(1) para SUBSTR(IIF(EMPTY(SE2->E2_FAGEDV),VAL(SA2->A2_DVAGE),VAL(SE2->E2_FAGEDV)),1,1)   
						cTxto +=PADR("21D1CONTA FAVORECID0300410U_GTFIN038(11,'CTAFAV')",500)+ ENTER
						cTxto +=PADR("21D1DV_CONTA       0420420SUBSTR(IIF(EMPTY(SE2->E2_FCTADV),SA2->A2_DVCTA,SE2->E2_FCTADV),1,1)",500)+ ENTER			//CAS - 24/06/2020 Ajustado Leiaute de SPACE(1) para SUBSTR(IIF(EMPTY(SE2->E2_FCTADV),VAL(SA2->A2_NUMCON),VAL(SE2->E2_FCTADV)),1,1)
						cTxto +=PADR("21D1DAC            0430430U_GTFIN038(11,'DACFAV')",500)+ ENTER
						cTxto +=PADR("21D1NOME FAVORECIDO0440730LEFT(IIF(EMPTY(SE2->E2_P_NOMBN),FwCutOff(ALLTRIM(SA2->A2_NOME),.T.),FwCutOff(ALLTRIM(SE2->E2_P_NOMBN),.T.)),30)",500)+ ENTER
						cTxto +=PADR("21D1SEU NUMERO     0740930SE2->E2_IDCNAB",500)+ ENTER
						cTxto +=PADR("21D1DT CREDITO     0941010GRAVADATA(SE2->E2_VENCREA,.F.,5)",500)+ ENTER
						cTxto +=PADR("21D1TIPO DA MOEDA  1021040SE2->E2_P_TPMOE",500)+ ENTER
						cTxto +=PADR("21D1QTD MOEDA      1051195STRZERO(0,15)",500)+ ENTER
						cTxto +=PADR("21D1VALOR LCTO     1201342STRZERO(((DDATABASE-SE2->E2_VENCTO)*SE2->E2_VALJUR)+((SE2->E2_SALDO-SE2->(SE2->E2_DECRESC))+SE2->E2_ACRESC)*100,15)",500)+ ENTER
						cTxto +=PADR("21D1NUM.DOC.NO BCO.1351540SPACE(20)",500)+ ENTER
						cTxto +=PADR("21D1DT EFET.DO PAG.1551620GRAVADATA(SE2->E2_VENCREA,.F.,5)",500)+ ENTER
						cTxto +=PADR("21D1VAL.EFET.DO PAG1631772STRZERO(((DDATABASE-SE2->E2_VENCTO)*SE2->E2_VALJUR)+((SE2->E2_SALDO-SE2->(SE2->E2_DECRESC))+SE2->E2_ACRESC)*100,15)",500)+ ENTER
						cTxto +=PADR("21D1INF.COMPL.HIST.1782170SPACE(40)",500)+ ENTER
						cTxto +=PADR("21D1COD FINAL DOC  2182190IIF(SEA->EA_MODELO$'03','01','')",500)+ ENTER												//CAS - 24/06/2020 Ajustado Leiaute, Codigo Finalidade Doc
						cTxto +=PADR("21D1COD FINAL TED  2202240IIF(SEA->EA_MODELO$'41/43','00010','')",500)+ ENTER											//CAS - 24/06/2020 Ajustado Leiaute, Codigo Finalidade TED
						cTxto +=PADR("21D1COD FINAL COMPL2252260IIF(SEA->EA_MODELO$'41/43',IIF(POSICIONE('SA2',1,XFILIAL('SA2')+SE2->E2_FORNECE+SE2->E2_LOJA,'A2_TIPCTA')=='1','CC',(IIF(POSICIONE('SA2',1,XFILIAL('SA2')+SE2->E2_FORNECE+SE2->E2_LOJA,'A2_TIPCTA')=='2','PP',''))),'')",500)+ ENTER	//CAS - 24/06/2020 Ajustado Leiaute, Codigo Finalidade Complementar
						cTxto +=PADR("21D1EXCLUS FEBRABAN2272290SPACE(3)",500)+ ENTER
						cTxto +=PADR("21D1AVISO          2302300'0'",500)+ ENTER
						cTxto +=PADR("21D1OCORRENCIA     2312400SPACE(10)",500)+ ENTER
						cTxto +=PADR("21D7BCO COMPENSACAO0010030SEE->EE_CODIGO",500)+ ENTER
						cTxto +=PADR("21D7LOTE SERVICO   0040070STRZERO(NLOTCNAB2,4)",500)+ ENTER
						cTxto +=PADR("21D7REG.DET. LOTE  0080080'3'",500)+ ENTER
						cTxto +=PADR("21D7SEQ REG LOTE   0090130STRZERO(F420SEQLOT(),5)",500)+ ENTER
						cTxto +=PADR("21D7SEG.REG.DET    0140140'J'",500)+ ENTER
						cTxto +=PADR("21D7EXCLUSIVO FEBRA0150150SPACE(1)",500)+ ENTER
						cTxto +=PADR("21D7TIPO DE MOV.   0160170'01'",500)+ ENTER
						cTxto +=PADR("21D7COD REG        0180190'52'",500)+ ENTER
						cTxto +=PADR("21D7TP INSC PGDOR  0200200'2'",500)+ ENTER
						cTxto +=PADR("21D7NUM INSC PGDOR 0210350PADL(ALLTRIM(SM0->M0_CGC),15,'0')",500)+ ENTER
						cTxto +=PADR("21D7NOME PGDOR     0360750SUBSTR(FwCutOff(ALLTRIM(SM0->M0_NOME),.T.),1,40)",500)+ ENTER
						cTxto +=PADR("21D7TP INSC BENEFIC0760760IIF(EMPTY(SE2->E2_P_TIPO),IF(SA2->A2_TIPO='J','2',IF(SA2->A2_TIPO='F','1','9')),IF(SE2->E2_P_TIPO='J','2',IF(SE2->E2_P_TIPO='F','1','9')))",500)+ ENTER
						cTxto +=PADR("21D7NUM INSC BENEFI0770910PADL(IIF(EMPTY(SE2->E2_P_CGCBN),SA2->A2_CGC,SE2->E2_P_CGCBN),15,'0')",500)+ ENTER
						cTxto +=PADR("21D7NOME BENEFI    0921310LEFT(IIF(EMPTY(SE2->E2_P_NOMBN),FwCutOff(ALLTRIM(SA2->A2_NOME),.T.),FwCutOff(ALLTRIM(SE2->E2_P_NOMBN),.T.)),30)",500)+ ENTER
						cTxto +=PADR("21D7TP INSC PGDORBN1321320'2'",500)+ ENTER
						cTxto +=PADR("21D7NUM INSC PGDORB1331470PADL(ALLTRIM(SM0->M0_CGC),15,'0')",500)+ ENTER
						cTxto +=PADR("21D7NOME PGDORBN   1481870SUBSTR(FwCutOff(ALLTRIM(SM0->M0_NOME),.T.),1,40)",500)+ ENTER
						cTxto +=PADR("21D7EXCLUSIVO FEBRA1882400SPACE(53)",500)+ ENTER
						cTxto +=PADR("21D6COD BANCO      0010030SEE->EE_CODIGO",500)+ ENTER         
						cTxto +=PADR("21D6COD LOTE       0040070STRZERO(NLOTCNAB2,4)",500)+ ENTER
						cTxto +=PADR("21D6TIPO REGISTRO  0080080'3'",500)+ ENTER
						cTxto +=PADR("21D6NUM REGISTRO   0090130STRZERO(F420SEQLOT(),5)",500)+ ENTER
						cTxto +=PADR("21D6SEGMENTO       0140140'N'",500)+ ENTER
						cTxto +=PADR("21D6TIPO MOVIMENTO 0150170PADL(AllTrim(SE2->E2_P_TPMV+SE2->E2_P_INSMV),3,'0')",500)+ ENTER
						cTxto +=PADR("21D6SEU NUMERO     0180370SE2->E2_IDCNAB",500)+ ENTER
						cTxto +=PADR("21D6NOSSO NUMERO   0380570SPACE(20)",500)+ ENTER
						cTxto +=PADR("21D6CONTRIBUINTE   0580870SUBSTR(FwCutOff(ALLTRIM(SE2->E2_P_NMCON),.T.),1,30)",500)+ ENTER
						cTxto +=PADR("21D6DATA PAGTO     0880950GRAVADATA(SE2->E2_VENCREA,.F.,5)",500)+ ENTER						//CAS - 24/06/2020 Ajustado Leiaute, estava GRAVADATA(DDATABASE,.F.,5)
						cTxto +=PADR("21D6VALOR PAGTO    0961102IF(SEA->EA_MODELO$'17',STRZERO(SE2->(E2_SALDO+E2_ACRESC+E2_P_VRENT+E2_MULTA+E2_JUROS-E2_DECRESC)*100,15),STRZERO(SE2->(E2_SALDO+E2_ACRESC+E2_MULTA+E2_JUROS-E2_DECRESC)*100,15))",500)+ ENTER  //CAS - 24/06/2020 Ajustado Leiaute, Adicionado os campos +E2_MULTA+E2_JUROS tanto no primeiro bloco do IIF como no segundo.
						cTxto +=PADR("21D6INFO COMPLEMENT1112300U_GTFIN038(5,'')",500)+ ENTER
						cTxto +=PADR("21D6OCORRENCIA     2312400SPACE(10)",500)+ ENTER
						cTxto +=PADR("21D8COD BANCO      0010030STRZERO(VAL(SEE->EE_CODIGO),3)",500)+ ENTER
						cTxto +=PADR("21D8LOTE SERVICO   0040070STRZERO(NLOTCNAB2,4)",500)+ ENTER
						cTxto +=PADR("21D8REG DET. LOTE  0080080'3'",500)+ ENTER
						cTxto +=PADR("21D8SEQ REG LOTE   0090130STRZERO(F420SEQLOT(),5)",500)+ ENTER
						cTxto +=PADR("21D8COD SEGMENTO   0140140'W'",500)+ ENTER
						cTxto +=PADR("21D8SEQ REG COMPLE 0150150STRZERO(0,1)",500)+ ENTER
						cTxto +=PADR("21D8USO INFO 1 E 2 0160160'9'",500)+ ENTER
						cTxto +=PADR("21D8INF COMPLE 1   0170960SPACE(80)",500)+ ENTER
						cTxto +=PADR("21D8INF COMPLE 2   0971760SPACE(80)",500)+ ENTER
						cTxto +=PADR("21D8INF COMPLE 3   1772280U_GTFIN038(6,'')",500)+ ENTER
						cTxto +=PADR("21D8EXCLUS FEBRABAN2292300SPACE(2)",500)+ ENTER
						cTxto +=PADR("21D8OCORRENCIA     2312400SPACE(10)",500)

						//FWrite - Comando reponsavel pela gravação do texto.
						FWrite(nHandle, cTxto)
						//FClose - Comando que fecha o arquivo, liberando o uso para outros programas.
						FClose(nHandle)
					EndIf
					IF FILE(aArqLay[c])
					    //AVISO("<center><h2><font color='#FF7B0D'>ARQUIVO CNAB A PAGAR CRIADO COM SUCESSO!!</font></h2></center>",cMSG+ENTER+ENTER+"( "+cDirArq+" )",{"OK"}, 3)
						cMsgLayout += aArqLay[c] + ENTER
						//AVISO("ARQUIVO DE LAYOUT CRIADO COM SUCESSO","O ARQUIVO: "+aArqLay[c]+" FOI CRIADO COM SUCESSO",{"OK"}, 3)
					ENDIF
				ENDIF
			//LAYOUT RETORNO CNAB A PAGAR
			ELSEIF aArqLay[c] == "FEBRABAN.2PR"
				//SE O ARQUIVO NÃO EXISTIR CRIA
				IF !FILE(aArqLay[c])
					nHandle := FCreate(aArqLay[c])
					If nHandle < 0
						MsgAlert("Erro durante criação do arquivo ("+aArqLay[c]+").")
					Else
						//
						cTxto  := ""
						//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
						// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! IMPORTANTE !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
						//³O ARQUIVO DEVE SER GERADO COM 500 POSIÇÕES POR ISSO DEVE MANTER OS ESPAÇOS                                         ³
						//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
						cTxto +=PADR("10H HEADER ARQUDIVO                .T.",500)+ ENTER
						cTxto +=PADR("10T TRAILLER PRINCIPAL            .T.",500)+ ENTER
						cTxto +=PADR("11D1SEGMENTO A                    A",500)+ ENTER
						cTxto +=PADR("11D2SEGMENTO B                    B",500)+ ENTER
						cTxto +=PADR("11D3SEGMENTO C                    C",500)+ ENTER
						cTxto +=PADR("11D4SEGMENTO J                    J",500)+ ENTER
						cTxto +=PADR("11D5SEGMENTO O                    O",500)+ ENTER
						cTxto +=PADR("11D6SEGMENTO N                    N",500)+ ENTER
						cTxto +=PADR("11D7SEGMENTO J-52                 J52",500)+ ENTER
						cTxto +=PADR("11DZSEGMENTO Z                    Z",500)+ ENTER
						cTxto +=PADR("11H HEADER LOTE - SEG. A/B/J/N/O  .T.",500)+ ENTER
						cTxto +=PADR("11T TRAILLER LOTE - SEG. A/B/J    .T.",500)+ ENTER   
						cTxto +=PADR("12T TRAILLER LOTE - SEG. O/N      .T.",500)+ ENTER
						cTxto +=PADR("21D2COD.SEQ.REG.DET0140140SEGMENTO",500)+ ENTER
						cTxto +=PADR("21D2VL ABATIMENTO  1511652ABATIMENTO",500)+ ENTER
						cTxto +=PADR("21D2VL DESCONTO    1661802DESCONTO",500)+ ENTER
						cTxto +=PADR("21D2VL MORA        1811952JUROS",500)+ ENTER
						cTxto +=PADR("21D2VL MULTA       1962102MULTA",500)+ ENTER
						cTxto +=PADR("21D4SEQ.REG.DET    0140140SEGMENTO",500)+ ENTER
						cTxto +=PADR("21D4DESCONTO       1151292DESCONTO",500)+ ENTER
						cTxto +=PADR("21D4ACRESCIMO      1301442JUROS",500)+ ENTER
						cTxto +=PADR("21D4DT EFET.DO PAG.1451520DATA",500)+ ENTER
						cTxto +=PADR("21D4VAL.EFET.DO PAG1531672VALOR",500)+ ENTER
						cTxto +=PADR("21D4SEU NUMERO     1832020TITULO",500)+ ENTER
						cTxto +=PADR("21D4NOSSO NUMERO   2032220NOSSONUMERO",500)+ ENTER
						cTxto +=PADR("21D4EXCLUS FEBRABAN2252300RESERVADO",500)+ ENTER
						cTxto +=PADR("21D4OCORRENCIA     2312400OCORRENCIA",500)+ ENTER
						cTxto +=PADR("21D5SEGMENTO       0140140SEGMENTO",500)+ ENTER
						cTxto +=PADR("21D5DATA PAGTO     1001070DATA",500)+ ENTER
						cTxto +=PADR("21D5VALOR PAGTO    1081222VALOR",500)+ ENTER
						cTxto +=PADR("21D5SEU NUMERO     1231420TITULO",500)+ ENTER
						cTxto +=PADR("21D5NOSSO NUMERO   1431620NOSSONUMERO",500)+ ENTER
						cTxto +=PADR("21D5EXCLUS FEBRABAN1632300RESERVADO",500)+ ENTER
						cTxto +=PADR("21D5OCORRENCIA     2312400OCORRENCIA",500)+ ENTER
						cTxto +=PADR("21D1COD.SEQ.REG.DET0140140SEGMENTO",500)+ ENTER
						cTxto +=PADR("21D1SEU NUMERO     0740930TITULO",500)+ ENTER
						cTxto +=PADR("21D1DT CREDITO     0941010DATA",500)+ ENTER
						cTxto +=PADR("21D1NUM.DOC.NO BCO.1351540NOSSONUMERO",500)+ ENTER
						cTxto +=PADR("21D1DT EFET.DO PAG.1551620DATA",500)+ ENTER
						cTxto +=PADR("21D1VAL.EFET.DO PAG1631772VALOR",500)+ ENTER
						cTxto +=PADR("21D1OCORRENCIA     2312400OCORRENCIA",500)+ ENTER
						cTxto +=PADR("21D7SEG.REG.DET    0140140SEGJ52",500)+ ENTER
						cTxto +=PADR("21D6SEGMENTO       0140140SEGMENTO",500)+ ENTER
						cTxto +=PADR("21D6SEU NUMERO     0180370TITULO",500)+ ENTER
						cTxto +=PADR("21D6NOSSO NUMERO   0380570NOSSONUMERO",500)+ ENTER
						cTxto +=PADR("21D6DATA PAGTO     0880950DATA",500)+ ENTER
						cTxto +=PADR("21D6VALOR PAGTO    0961102VALOR",500)+ ENTER				
						cTxto +=PADR("21D6OCORRENCIA     2312400OCORRENCIA",500)+ ENTER
						cTxto +=PADR("21DZREG. DETA LOT  0080080'3'",500)+ ENTER
						cTxto +=PADR("21DZCOD SEG REG DET0140140SEGMENTO",500)+ ENTER
						cTxto +=PADR("21DZAUTENTICACAO   0150780AUTENTICACAO",500)+ ENTER
						cTxto +=PADR("21DZEXCLUS FEBRABAN1042300RESERVADO",500)+ ENTER
						cTxto +=PADR("21DZOCORRENCIA     231240 OCORRENCIA",500)+ ENTER

						//FWrite - Comando reponsavel pela gravação do texto.
						FWrite(nHandle, cTxto)
						//FClose - Comando que fecha o arquivo, liberando o uso para outros programas.
						FClose(nHandle)
					EndIf
					IF FILE(aArqLay[c])
						cMsgLayout += aArqLay[c] + ENTER
						//AVISO("ARQUIVO DE LAYOUT CRIADO COM SUCESSO","O ARQUIVO: "+aArqLay[c]+" FOI CRIADO COM SUCESSO",{"OK"}, 3)
					ENDIF
				ENDIF
			
			//LAYOUT REMESSA CNAB A RECEBER
			ELSEIF aArqLay[c] == "FEBRABAN.2RE"
				//SE O ARQUIVO NÃO EXISTIR CRIA
				IF !FILE(aArqLay[c])
					nHandle := FCreate(aArqLay[c])
					If nHandle < 0
						MsgAlert("Erro durante criação do arquivo ("+aArqLay[c]+").")
					Else
						//
						cTxto  := ""
						//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
						// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! IMPORTANTE !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
						//³O ARQUIVO DEVE SER GERADO COM 500 POSIÇÕES POR ISSO DEVE MANTER OS ESPAÇOS                                         ³
						//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
						cTxto +=PADR("10H Header de Arquivo             .T.",500)+ ENTER
						cTxto +=PADR("10T TRAILLER DE ARQUIVO           .T.",500)+ ENTER
						cTxto +=PADR("11D1DETALHE SEGMENTO P            .T.",500)+ ENTER
						cTxto +=PADR("11D2DETALHE SEGMENTO Q            .T.",500)+ ENTER
						cTxto +=PADR("11D3DETALHE SEGMENTO R            .T.",500)+ ENTER
						cTxto +=PADR("11D4DETALHE SEGMENTO S            .T.",500)+ ENTER
						cTxto +=PADR("11H HEADER DE LOTE                .T.",500)+ ENTER
						cTxto +=PADR("11T TRAILLER DE LOTE              .T.",500)+ ENTER
						cTxto +=PADR("20H COD. BANCO COMP0010030SEE->EE_CODIGO",500)+ ENTER
						cTxto +=PADR("20H LOTE DE SERVICO0040070'0000'",500)+ ENTER
						cTxto +=PADR("20H REG. HEADER ARQ0080080'0'",500)+ ENTER
						cTxto +=PADR("20H TIPO OPERACAO  0090170SPACE(9)",500)+ ENTER
						cTxto +=PADR("20H TIPO INSCRICAO 0180180'2'",500)+ ENTER
						cTxto +=PADR("20H NUM INSCRICAO  0190320PADL(ALLTRIM(SM0->M0_CGC),14,'0')",500)+ ENTER
						cTxto +=PADR("20H CONVENIO BANCO 0330520SUBSTR(SEE->EE_CODEMP,1,20)",500)+ ENTER
						cTxto +=PADR("20H AGENCIA        0530570STRZERO(VAL(SEE->EE_AGENCIA),5)",500)+ ENTER
						cTxto +=PADR("20H DV AGENCIA     0580580SUBSTR(SEE->EE_DVAGE,1,1)",500)+ ENTER
						cTxto +=PADR("20H CONTA          0590700IIF(SEE->EE_CODIGO$'745',STRZERO(VAL(SEE->EE_CONTA),12),IF(EMPTY(SEE->EE_DVCTA),LEFT(STRZERO(VAL(SEE->EE_CONTA),13),12),STRZERO(VAL(SEE->EE_CONTA),12)))",500)+ ENTER ////CAS - 24/06/2020 Ajustado Leiaute da Conta
						cTxto +=PADR("20H DV CONTA       0710710IIF(EMPTY(SEE->EE_DVCTA),RIGHT(ALLTRIM(SEE->EE_CONTA),1),SEE->EE_DVCTA)",500)+ ENTER		//CAS - 28/12/2020 Ajustado Leiaute de SUBSTR(SEE->EE_DVCTA,1,1) para IIF(EMPTY(SEE->EE_DVCTA),RIGHT(ALLTRIM(SEE->EE_CONTA),1),SEE->EE_DVCTA)
						cTxto +=PADR("20H DV AG/CONTA    0720720IIF(SEE->EE_CODIGO$'745',' ',RIGHT(ALLTRIM(SEE->EE_CONTA+SEE->EE_DVCTA),1))",500)+ ENTER	//CAS - 24/06/2020 Ajustado Leiaute de SPACE(1) para o atual
						cTxto +=PADR("20H NOME EMPRESA   0731020SUBSTR(SM0->M0_NOME,1,30)",500)+ ENTER
						cTxto +=PADR("20H NOME BANCO     1031320SUBSTR(SA6->A6_NOME,1,30)",500)+ ENTER
						cTxto +=PADR("20H EXCLUS FEBRABAN1331420SPACE(10)",500)+ ENTER
						cTxto +=PADR("20H COD REM/RET    1431430'1'",500)+ ENTER
						cTxto +=PADR("20H DATA GER ARQ   1441510GRAVADATA(DDATABASE,.F.,5)",500)+ ENTER
						cTxto +=PADR("20H HORA GER ARQ   1521570STRTRAN(TIME(),':')",500)+ ENTER
						cTxto +=PADR("20H NUM SEQ ARQ    1581630STRZERO(VAL(SEE->EE_ULTDSK)+1,6)",500)+ ENTER												//CAS - 24/06/2020 Ajustado Leiaute, adicionado o +1												
						cTxto +=PADR("20H VER LAYOUT     1641660'103'",500)+ ENTER
						cTxto +=PADR("20H DENS GRAV ARQ  1671710'01600'",500)+ ENTER
						cTxto +=PADR("20H USO RES BANCO  1721910SPACE(20)",500)+ ENTER
						cTxto +=PADR("20H USO RES EMPRESA1922110SPACE(20)",500)+ ENTER
						cTxto +=PADR("20H EXCLUS FEBRABAN2122400SPACE(29)",500)+ ENTER
						cTxto +=PADR("21T COD BCO COMPENS0010030SEE->EE_CODIGO",500)+ ENTER
						cTxto +=PADR("21T LOTE SERVICO   0040070'0001'",500)+ ENTER
						cTxto +=PADR("21T REG. TRAIL LOTE0080080'5'",500)+ ENTER
						cTxto +=PADR("21T USO EXCL.CNAB  0090170SPACE(9)",500)+ ENTER
						cTxto +=PADR("21T QTD REG. LOTE  0180230STRZERO(F420LINLOT()-2,6)",500)+ ENTER
						cTxto +=PADR("21T QUANT.TITULO   0240290STRZERO((F420LINLOT()-2)/2,6)",500)+ ENTER
						cTxto +=PADR("21T VLR. TOTAL TIT.0300462STRZERO(SOMAVALOR(),17)",500)+ ENTER		//CAS 06-02-2021 Alterado de NSOMAVLLOTE para SOMAVALOR()
						cTxto +=PADR("21T QUANT.TITULO   0470520STRZERO(0,6)",500)+ ENTER
						cTxto +=PADR("21T VLR. TOTAL TIT.0530692STRZERO(0,17)",500)+ ENTER
						cTxto +=PADR("21T QUANT. TITULO  0700750STRZERO(0,6)",500)+ ENTER
						cTxto +=PADR("21T VLR. TOTAL TIT.0760922STRZERO(0,17)",500)+ ENTER
						cTxto +=PADR("21T QUANT. TITULO  0930980STRZERO(0,6)",500)+ ENTER
						cTxto +=PADR("21T VLR. TOTAL TIT.0991152STRZERO(0,17)",500)+ ENTER
						cTxto +=PADR("21T NRO AVISO LANC 1161230SPACE(8)",500)+ ENTER
						cTxto +=PADR("21T USO EXCL.CNAB  1242400SPACE(117)",500)+ ENTER
						cTxto +=PADR("21H COD BCO COMPENS0010030SEE->EE_CODIGO",500)+ ENTER
						cTxto +=PADR("21H LOTE DE SERVICO0040070STRZERO(FNLOTECNAB(),4)",500)+ ENTER			//CAS 06-02-2021 Ajustado, de NLOTCNAB2 para FNLOTECNAB()
						cTxto +=PADR("21H REG. HEADER LOT0080080'1'",500)+ ENTER
						cTxto +=PADR("21H TIPO OPERACAO  0090090'R'",500)+ ENTER
						cTxto +=PADR("21H TIPO SERVICO   0100110'01'",500)+ ENTER
						cTxto +=PADR("21H EXCLUSI FEBRABA0120130SPACE(2)",500)+ ENTER
						cTxto +=PADR("21H NO. VER. LAYOUT0140160'060'",500)+ ENTER
						cTxto +=PADR("21H EXCLUSI FEBRABA0170170SPACE(1)",500)+ ENTER
						cTxto +=PADR("21H TIPO INSCR. EMP0180180'2'",500)+ ENTER
						cTxto +=PADR("21H NO. INSCR EMPRE0190330PADL(ALLTRIM(SM0->M0_CGC),15,'0')",500)+ ENTER
						cTxto +=PADR("21H COD CONV BCO   0340530SUBSTR(SEE->EE_CODEMP,1,20)",500)+ ENTER
						cTxto +=PADR("21H AGENCIA CONTA  0540580STRZERO(VAL(SEE->EE_AGENCIA),5)",500)+ ENTER
						cTxto +=PADR("21H DIGITO AGENCIA 0590590SUBSTR(SEE->EE_DVAGE,1,1)",500)+ ENTER
						cTxto +=PADR("21H NRO C/C        0600710IIF(SEE->EE_CODIGO$'745',STRZERO(VAL(SEE->EE_CONTA),12),IF(EMPTY(SEE->EE_DVCTA),LEFT(STRZERO(VAL(SEE->EE_CONTA),13),12),STRZERO(VAL(SEE->EE_CONTA),12)))",500)+ ENTER  //CAS - 28/12/2020 Ajustado Leiaute para IIF(EMPTY(SEE->EE_DVCTA),RIGHT(ALLTRIM(SEE->EE_CONTA),1),SEE->EE_DVCTA)
						cTxto +=PADR("21H DIGITO CONTA   0720720IIF(EMPTY(SEE->EE_DVCTA),RIGHT(ALLTRIM(SEE->EE_CONTA),1),SEE->EE_DVCTA)",500)+ ENTER		//CAS - 28/12/2020 Ajustado Leiaute de SUBSTR(SEE->EE_DVCTA,1,1) para IIF(EMPTY(SEE->EE_DVCTA),RIGHT(ALLTRIM(SEE->EE_CONTA),1),SEE->EE_DVCTA)
						cTxto +=PADR("21H DIGITO AG/CONTA0730730IIF(SEE->EE_CODIGO$'745',' ',RIGHT(ALLTRIM(SEE->EE_CONTA+SEE->EE_DVCTA),1))",500)+ ENTER	//CAS - 24/06/2020 Ajustado Leiaute Digito Verificado Agencia/Conta
						cTxto +=PADR("21H NOME DA EMPRESA0741030SUBSTR(SM0->M0_NOME,1,30)",500)+ ENTER
						cTxto +=PADR("21H MENSAGEM 1     1041430U_GTFIN038(8,'MSG1')",500)+ ENTER
						cTxto +=PADR("21H MENSAGEM 2     1441830U_GTFIN038(8,'MSG1')",500)+ ENTER
						cTxto +=PADR("21H NRO REM/RET    1841910STRZERO(VAL(SEE->EE_ULTDSK),8)",500)+ ENTER
						cTxto +=PADR("21H DATAGRA REM/RET1921990STRZERO(DAY(DDATABASE),2)+STRZERO(MONTH(DDATABASE),2)+STRZERO(YEAR(DDATABASE),4)",500)+ ENTER
						cTxto +=PADR("21H DATA CREDITO   2002070STRZERO(0,8)",500)+ ENTER
						cTxto +=PADR("21H USO EXCL.CNAB  2082400SPACE(33)",500)+ ENTER
						cTxto +=PADR("21D2COD BCO COMPENS0010030SEE->EE_CODIGO",500)+ ENTER
						cTxto +=PADR("21D2LOTE SERVICO   0040070STRZERO(FNLOTECNAB(),4)",500)+ ENTER						//CAS 06-02-2021 Ajustado, de NLOTCNAB2 para FNLOTECNAB()
						cTxto +=PADR("21D2REGISTRO DETALH0080080'3'",500)+ ENTER
						cTxto +=PADR("21D2N. SEQ REG LOTE0090130STRZERO(F420SEQLOT(),5)",500)+ ENTER
						cTxto +=PADR("21D2COD. SEG. DETAL0140140'Q'",500)+ ENTER
						cTxto +=PADR("21D2USO EXCL.CNAB1 0150150SPACE(1)",500)+ ENTER
						cTxto +=PADR("21D2CODIGO MOVIMENT0160170IIF(EMPTY(SE1->E1_OCORREN),'01',SE1->E1_OCORREN)",500)+ ENTER	//CAS - 05/02/2021 - Ajuste Cobrança
						cTxto +=PADR("21D2TIPO INSCRICAO 0180180IIF(ALLTRIM(SA1->A1_PESSOA) == 'F','1','2')",500)+ ENTER
						cTxto +=PADR("21D2NUMERO INSCRICA0190330STRZERO(VAL(ALLTRIM(SA1->A1_CGC)),15)",500)+ ENTER
						cTxto +=PADR("21D2NOME           0340730SUBSTR(FwCutOff(ALLTRIM(SA1->A1_NOME),.T.),1,40)",500)+ ENTER
						cTxto +=PADR("21D2ENDERECO       0741130SUBSTR(FwCutOff(ALLTRIM(SA1->A1_END),.T.),1,40)",500)+ ENTER
						cTxto +=PADR("21D2BAIRRO         1141280SUBSTR(FwCutOff(ALLTRIM(SA1->A1_BAIRRO),.T.),1,15)",500)+ ENTER
						cTxto +=PADR("21D2CEP            1291330SUBSTR(FwCutOff(ALLTRIM(SA1->A1_CEP),.T.),1,5)",500)+ ENTER
						cTxto +=PADR("21D2SUFIXO CEP     1341360SUBSTR(FwCutOff(ALLTRIM(SA1->A1_CEP),.T.),6,3)",500)+ ENTER
						cTxto +=PADR("21D2CIDADE         1371510SUBSTR(FwCutOff(ALLTRIM(SA1->A1_MUN),.T.),1,15)",500)+ ENTER
						cTxto +=PADR("21D2UNID. FEDERACAO1521530SUBSTR(FwCutOff(ALLTRIM(SA1->A1_EST),.T.),1,2)",500)+ ENTER
						cTxto +=PADR("21D2TIPO INSCRICAO 1541540STRZERO(0,1)",500)+ ENTER
						cTxto +=PADR("21D2NUMERO INSCRICA1551690STRZERO(0,15)",500)+ ENTER
						cTxto +=PADR("21D2NOME SAC/AVALIS1702090SPACE(40)",500)+ ENTER
						cTxto +=PADR("21D2COD. BCO CORRES2102120STRZERO(0,3)",500)+ ENTER
						cTxto +=PADR("21D2NOSSO NUM. BCO.2132320SPACE(20)",500)+ ENTER 		//CAS 05/02/2021 - Alterado de NOSSONUM() para SPACE(20)
						cTxto +=PADR("21D2USO EXCL.CNAB  2332400SPACE(8)",500)+ ENTER
						cTxto +=PADR("20T COD BCO COMPENS0010030SEE->EE_CODIGO",500)+ ENTER
						cTxto +=PADR("20T LOTE SERVICO   0040070'9999'",500)+ ENTER
						cTxto +=PADR("20T TIPO REGISTRO  0080080'9'",500)+ ENTER
						cTxto +=PADR("20T EXCLUSIV FEBRAB0090170SPACE(9)",500)+ ENTER
						cTxto +=PADR("20T QTD REG LOTE   0180230'000001'",500)+ ENTER
						cTxto +=PADR("20T QTD REG ARQ    0240290STRZERO(F420LINLOT()-2,6)",500)+ ENTER
						cTxto +=PADR("20T QTD CONTAS     0300350STRZERO(0,6)",500)+ ENTER
						cTxto +=PADR("20T EXCLUSIV FEBRAB0362400SPACE(205)",500)+ ENTER
						cTxto +=PADR("21D3COD BCO COMPENS0010030SEE->EE_CODIGO",500)+ ENTER
						cTxto +=PADR("21D3LOTE SERVICO   0040070STRZERO(FNLOTECNAB(),4)",500)+ ENTER								//CAS 06-02-2021 Ajustado, de NLOTCNAB2 para FNLOTECNAB()
						cTxto +=PADR("21D3REGISTRO DETALH0080080'3'",500)+ ENTER
						cTxto +=PADR("21D3N. SEQ REG LOTE0090130STRZERO(F420SEQLOT(),5)",500)+ ENTER
						cTxto +=PADR("21D3COD SEG REG DET0140140'R'",500)+ ENTER
						cTxto +=PADR("21D3USO EXCL. CNAB10150150SPACE(1)",500)+ ENTER
						cTxto +=PADR("21D3CODIGO MOVIMENT0160170IIF(EMPTY(SE1->E1_OCORREN),'01',SE1->E1_OCORREN)",500)+ ENTER		//CAS - 05/02/2021 - Ajuste Cobrança
						cTxto +=PADR("21D3COD DESC 2     0180180'0'",500)+ ENTER
						cTxto +=PADR("21D3DATA DESC 2    0190260STRZERO(0,8)",500)+ ENTER
						cTxto +=PADR("21D3VAL PERCENT CON0270412STRZERO(0,15)",500)+ ENTER
						cTxto +=PADR("21D3COD DESC 3     0420420'0'",500)+ ENTER
						cTxto +=PADR("21D3DATA DESC 3    0430500STRZERO(0,8)",500)+ ENTER
						cTxto +=PADR("21D3VAL PERCENT CON0510652STRZERO(0,15)",500)+ ENTER
						cTxto +=PADR("21D3COD MULTA      0660660STRZERO(VAL(IIF(EMPTY(ALLTRIM(SE1->E1_P_TPMUL)),'2',SE1->E1_P_TPMUL)),1)",500)+ ENTER		//CAS - 08/02/2021 - Ajuste Cobrança Multa - Antes era STRZERO(VAL(ALLTRIM(SE1->E1_P_TPMUL)),1)
						cTxto +=PADR("21D3DATA MULTA     0670740GRAVADATA(SE1->E1_VENCREAL,.F.,5)",500)+ ENTER
						cTxto +=PADR("21D3VAL PERCENT APL0750892STRZERO(IIF(ALLTRIM(SA1->A1_P_CL_PA)=='1',SA1->A1_P_PERMT*100,SEE->EE_P_PERMT*100),15)",500)+ ENTER	//CAS - 11/02/2021 - Ajuste Cobrança Multa - Percentual	
						cTxto +=PADR("21D3INF AO PAGADOR 0900990SPACE(10)",500)+ ENTER
						cTxto +=PADR("21D3MENSAGEM 3     1001390SPACE(40)",500)+ ENTER
						cTxto +=PADR("21D3MENSAGEM 4     1401790SPACE(40)",500)+ ENTER
						cTxto +=PADR("21D3EXCLUS FEBRABAN1801990SPACE(20)",500)+ ENTER
						cTxto +=PADR("21D3COD OR PAGADOR 2002070STRZERO(0,8)",500)+ ENTER
						cTxto +=PADR("21D3COD BCO CTA DEB2082100STRZERO(VAL(SA1->A1_BCO1),3)",500)+ ENTER		//CAS 08/08/2019 - Ajustado o SA1->A1_BCO1 para STRZERO(VAL(SA1->A1_BCO1),3)
						cTxto +=PADR("21D3COD AGE DEB    2112150STRZERO(VAL(SA1->A1_P_AGECL),5)",500)+ ENTER
						cTxto +=PADR("21D3DG VR AGE      2162160SPACE(1)",500)+ ENTER
						cTxto +=PADR("21D3CTA DEBITO     2172280PADL(SA1->(SUBSTR(ALLTRIM(A1_P_CTACL),1,LEN(ALLTRIM(A1_P_CTACL))-1)),12,'0')",500)+ ENTER
						cTxto +=PADR("21D3DG VR CTA      2292290SPACE(1)",500)+ ENTER
						cTxto +=PADR("21D3DG VR AG/CTA   2302300SA1->(SUBSTR(ALLTRIM(A1_P_CTACL),-1,1))",500)+ ENTER
						cTxto +=PADR("21D3AV DEB AUTO    2312310'0'",500)+ ENTER
						cTxto +=PADR("21D3EXCLIS FEBRABAN2322400SPACE(9)",500)+ ENTER
						cTxto +=PADR("21D1COD BCO COMPENS0010030ALLTRIM(SEE->EE_CODIGO)",500)+ ENTER
						cTxto +=PADR("21D1LOTE DE SERVICO0040070STRZERO(FNLOTECNAB(),4)",500)+ ENTER					//CAS 06-02-2021 Ajustado, de NLOTCNAB2 para FNLOTECNAB()
						cTxto +=PADR("21D1REGISTRO DETALH0080080'3'",500)+ ENTER
						cTxto +=PADR("21D1NO. SEQ. LOTE  0090130STRZERO(F420SEQLOT(),5)",500)+ ENTER
						cTxto +=PADR("21D1COD SEG. DETALH0140140'P'",500)+ ENTER
						cTxto +=PADR("21D1USO EXCL.CNAB  0150150SPACE(1)",500)+ ENTER
						cTxto +=PADR("21D1CODIGO MOVIMENT0160170IIF(EMPTY(SE1->E1_OCORREN),'01',SE1->E1_OCORREN)",500)+ ENTER		//CAS - 05/02/2021 - Ajuste Cobrança
						cTxto +=PADR("21D1AGENCIA MANTENE0180220STRZERO(VAL(SEE->EE_AGENCIA),5)",500)+ ENTER			//CAS - 24/06/2020 Ajustado Leiaute, de SA6->A6_AGENCIA para SEE->EE_AGENCIA
						cTxto +=PADR("21D1DIGIT VERIF AGE0230230SUBSTR(SEE->EE_DVAGE,1,1)",500)+ ENTER					//CAS - 28/12/2020 Ajustado Leiaute, de SA6->A6_DVAGE 	para SUBSTR(SEE->EE_DVAGE,1,1)
						cTxto +=PADR("21D1NO. CONTA CORRE0240350IIF(SEE->EE_CODIGO$'745',STRZERO(VAL(SEE->EE_CONTA),12),IF(EMPTY(SEE->EE_DVCTA),LEFT(STRZERO(VAL(SEE->EE_CONTA),13),12),STRZERO(VAL(SEE->EE_CONTA),12)))",500)+ ENTER		//CAS - 28/12/2020 Ajustado Leiaute, de SA6->A6_NUMCON  para SEE->EE_CONTA
						cTxto +=PADR("21D1DIGIT VERIF CON0360360IIF(EMPTY(SEE->EE_DVCTA),RIGHT(ALLTRIM(SEE->EE_CONTA),1),SEE->EE_DVCTA)",500)+ ENTER					//CAS - 28/12/2020 Ajustado Leiaute, de SPACE(1)        para SUBSTR(SEE->EE_DVCTA,1,1) 
						cTxto +=PADR("21D1DIGIT VER AG/CO0370370IIF(SEE->EE_CODIGO$'745',' ',RIGHT(ALLTRIM(SEE->EE_CONTA+SEE->EE_DVCTA),1))",500)+ ENTER  //CAS - 24/06/2020 Ajustado Leiaute, de SA6->(IIF(EMPTY(ALLTRIM(A6_DVCTA)),SUBSTR(ALLTRIM(A6_NUMCON),-1,1),ALLTRIM(A6_DVCTA)))
						cTxto +=PADR("21D1IDENT. TIT. BCO0380570IIF(EMPTY(SE1->E1_NUMBCO),NOSSONUM(),SE1->E1_NUMBCO)",500)+ ENTER  //CAS - 05/02/2021 - Ajuste NossoNum
						cTxto +=PADR("21D1COD CARTEIRA   0580580'1'",500)+ ENTER
						cTxto +=PADR("21D1FORMA CAD. TIT.0590590'1'",500)+ ENTER
						cTxto +=PADR("21D1TIPO DOCUMENTO 0600600'2'",500)+ ENTER
						cTxto +=PADR("21D1IDENT. EMIS BLO0610610'2'",500)+ ENTER				//CAS - 05/02/2021 - Ajuste Emissao/Distr Boleto
						cTxto +=PADR("21D1IDENT. DISTRIB.0620620'2'",500)+ ENTER				//CAS - 05/02/2021 - Ajuste Emissao/Distr Boleto
						cTxto +=PADR("21D1NO. DOC. COBRAN0630770SUBSTR(SE1->(E1_IDCNAB),1,15)",500)+ ENTER				//CAS 24/06/2019 - Alterado o E1_NUMBOR para E1_IDCNAB
						cTxto +=PADR("21D1DATA VENC TITUL0780850GRAVADATA(SE1->E1_VENCREAL,.F.,5)",500)+ ENTER
						cTxto +=PADR("21D1VL. NOMINAL TIT0861002STRZERO(INT((SE1->E1_VALOR-SE1->E1_DECRESC)*100),15)",500)+ ENTER
						cTxto +=PADR("21D1AGENCIA ENC COB1011050STRZERO(0,5)",500)+ ENTER
						cTxto +=PADR("21D1DIGIT VERIF AGE1061060SPACE(1)",500)+ ENTER
						cTxto +=PADR("21D1ESPECIE TITULO 1071080'18'",500)+ ENTER
						cTxto +=PADR("21D1IDENT. ACEITO/N1091090SEE->EE_P_ACEIT",500)+ ENTER
						cTxto +=PADR("21D1DATA EMIS. TITU1101170GRAVADATA(SE1->E1_EMISSAO, .F.,5)",500)+ ENTER
						cTxto +=PADR("21D1COD. JUROS MORA1181180STRZERO(VAL(IIF(ALLTRIM(SA1->A1_P_CL_PA)=='1',ALLTRIM(SA1->A1_P_TIPO),ALLTRIM(SEE->EE_P_TIPO))),1)",500)+ ENTER
						cTxto +=PADR("21D1DATA JUROS MORA1191260GRAVADATA(SE1->E1_VENCREAL,.F.,5)",500)+ ENTER
						cTxto +=PADR("21D1JUROS MORA/D/TA1271412STRZERO(IIF(ALLTRIM(SA1->A1_P_CL_PA)=='1',(ROUND(SE1->E1_SALDO*SA1->A1_P_PERJR/100,2))*100,(ROUND(SE1->E1_SALDO*SEE->EE_P_PERJR/100,2))*100),15,0)",500)+ ENTER	//CAS - 05/02/2021 Ajustado Leiaute, para  (ROUND(SE1->E1_SALDO*SEE->EE_P_PERJR/100,2))*100
						cTxto +=PADR("21D1CODIGO DESC 1  1421420STRZERO(VAL(ALLTRIM(SE1->E1_TIPODES)),1)",500)+ ENTER
						cTxto +=PADR("21D1DATA DESC 1    1431500GRAVADATA(SE1->E1_VENCREAL,.F.,5)",500)+ ENTER
						cTxto +=PADR("21D1VALOR/PERC CONC1511652STRZERO(SE1->E1_DESCFIN,15)",500)+ ENTER
						cTxto +=PADR("21D1VALOR IOF RECOL1661802STRZERO(0,15)",500)+ ENTER
						cTxto +=PADR("21D1VALOR ABATIMENT1811952STRZERO(SE1->E1_DECRESC,15)",500)+ ENTER
						cTxto +=PADR("21D1IDENT. TIT. EMP1962200SE1->E1_IDCNAB",500)+ ENTER
						cTxto +=PADR("21D1CODIGO PROTESTO2212210STRZERO(VAL(IIF(ALLTRIM(SA1->A1_P_CL_PA)=='1',ALLTRIM(SA1->A1_P_PROTE),ALLTRIM(SEE->EE_P_PROTE))),1)",500)+ ENTER
						cTxto +=PADR("21D1NO. DIAS PROTES2222230STRZERO(VAL(IIF(ALLTRIM(SA1->A1_P_CL_PA)=='1',SA1->A1_P_DIASP,SEE->EE_DIASPRT)),2)",500)+ ENTER
						cTxto +=PADR("21D1COD. BAIXA DEV.2242240'1'",500)+ ENTER										//CAS - 28/12/2020 Ajustado Leiaute de STRZERO(0,1) para '1'
						cTxto +=PADR("21D1N. DIAS BAI/DEV2252270'030'",500)+ ENTER										//CAS - 28/12/2020 Ajustado Leiaute de STRZERO(0,3) para '030'
						cTxto +=PADR("21D1CODIGO MOEDA   2282290'09'",500)+ ENTER
						cTxto +=PADR("21D1N. CONT. OP CRE2302390STRZERO(0,10)",500)+ ENTER
						cTxto +=PADR("21D1USO EXCL. CNAB22402400SPACE(1)",500)+ ENTER
						cTxto +=PADR("21D4COD BCO COMPENS0010030SEE->EE_CODIGO",500)+ ENTER
						cTxto +=PADR("21D4LOTE SERVICO   0040070STRZERO(FNLOTECNAB(),4)",500)+ ENTER					//CAS 06-02-2021 Ajustado, de NLOTCNAB2 para FNLOTECNAB()
						cTxto +=PADR("21D4REGISTRO DETALH0080080'3'",500)+ ENTER
						cTxto +=PADR("21D4NO. SEQ. LOTE  0090130STRZERO(F420SEQLOT(),5)",500)+ ENTER
						cTxto +=PADR("21D4COD SEG DETALHE0140140'S'",500)+ ENTER
						cTxto +=PADR("21D4EXCLUS FEBRABAN0150150SPACE(1)",500)+ ENTER
						cTxto +=PADR("21D4CODIGO MOVIMENT0160170IIF(EMPTY(SE1->E1_OCORREN),'01',SE1->E1_OCORREN)",500)+ ENTER		//CAS - 05/02/2021 - Ajuste Cobrança
						cTxto +=PADR("21D4TIPO DE IMPRESS0182400U_GTFIN038(7,'')",500)+ ENTER
											
						//FWrite - Comando reponsavel pela gravação do texto.
						FWrite(nHandle, cTxto)
						//FClose - Comando que fecha o arquivo, liberando o uso para outros programas.
						FClose(nHandle)

					EndIf
					IF FILE(aArqLay[c])
						cMsgLayout += aArqLay[c] + ENTER
						//AVISO("ARQUIVO DE LAYOUT CRIADO COM SUCESSO","O ARQUIVO: "+aArqLay[c]+" FOI CRIADO COM SUCESSO",{"OK"}, 3)
					ENDIF
				ENDIF
			//LAYOUT RETORNO CNAB A RECEBER
			ELSEIF aArqLay[c] == "FEBRABAN.2RR"
				//SE O ARQUIVO NÃO EXISTIR CRIA
				IF !FILE(aArqLay[c])
					nHandle := FCreate(aArqLay[c])
					If nHandle < 0
						MsgAlert("Erro durante criação do arquivo ("+aArqLay[c]+").")
					Else
						//
						cTxto  := ""
						//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
						// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! IMPORTANTE !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
						//³O ARQUIVO DEVE SER GERADO COM 500 POSIÇÕES POR ISSO DEVE MANTER OS ESPAÇOS                                         ³
						//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
						cTxto +=PADR("10H Header de Arquivo              ",500)+ ENTER
						cTxto +=PADR("10T TRAILLER DE ARQUIVO            ",500)+ ENTER
						cTxto +=PADR("11D1DETALHE SEGMENTO              T",500)+ ENTER
						cTxto +=PADR("11D2DETALHE SEGMENTO              U",500)+ ENTER
						cTxto +=PADR("11H HEADER DE LOTE                 ",500)+ ENTER
						cTxto +=PADR("11T TRAILLER DE LOTE               ",500)+ ENTER
						cTxto +=PADR("21D1COD BCO COMPENS0010030",500)+ ENTER
						cTxto +=PADR("21D1LOTE DE SERVICO0040070",500)+ ENTER
						cTxto +=PADR("21D1REGISTRO DETALH0080080'3'",500)+ ENTER
						cTxto +=PADR("21D1NO. SEQ. LOTE  0090130",500)+ ENTER
						cTxto +=PADR("21D1COD SEG. DETALH0140140SEGMENTO",500)+ ENTER
						cTxto +=PADR("21D1USO EXCL.CNAB  0150150",500)+ ENTER
						cTxto +=PADR("21D1CODIGO MOVIMENT0160170OCORRENCIA",500)+ ENTER
						cTxto +=PADR("21D1AGENCIA MANTENE0180220",500)+ ENTER
						cTxto +=PADR("21D1DIGIT VERIF AGE0230230",500)+ ENTER
						cTxto +=PADR("21D1NO. CONTA CORRE0240350",500)+ ENTER
						cTxto +=PADR("21D1DIGIT VERIF CON0360360",500)+ ENTER
						cTxto +=PADR("21D1DIGIT VER AG/CO0370370",500)+ ENTER
						cTxto +=PADR("21D1NOSSO NUM.     0380570NOSSONUMERO",500)+ ENTER
						cTxto +=PADR("21D1COD CARTEIRA   0580580",500)+ ENTER      
						cTxto +=PADR("21D1NUM. DOCUMENTO 0590730DOCUMENTO",500)+ ENTER     //CAS 26/07/2019 - Alterado o TITULO para E1_IDCNAB
						cTxto +=PADR("21D1DT VENCTO      0740810DATA",500)+ ENTER
						cTxto +=PADR("21D1VL TITULO      0820962",500)+ ENTER
						cTxto +=PADR("21D1BCO COBRANCA   0970990",500)+ ENTER
						cTxto +=PADR("21D1AG COBRANCA    1001040",500)+ ENTER
						cTxto +=PADR("21D1DV AGE COBRAN  1051050",500)+ ENTER
						cTxto +=PADR("21D1ID TITULO EMPRE1061300TITULO",500)+ ENTER
						cTxto +=PADR("21D1COD MOEDA      1311320",500)+ ENTER
						cTxto +=PADR("21D1TP INSCRICAO   1331330",500)+ ENTER
						cTxto +=PADR("21D1NUM INSCRICAO  1341480",500)+ ENTER
						cTxto +=PADR("21D1NOME PAGADOR   1491880",500)+ ENTER
						cTxto +=PADR("21D1NUM CONTRATO   1891980",500)+ ENTER
						cTxto +=PADR("21D1VALOR TARIFA   1992132",500)+ ENTER
						cTxto +=PADR("21D1MOTIVO OCORREN 2142230MOTIVO",500)+ ENTER
						cTxto +=PADR("21D1EXCLU FEBRABAN 2242400",500)+ ENTER
						cTxto +=PADR("21D2COD BCO COMPENS0010030",500)+ ENTER
						cTxto +=PADR("21D2LOTE SERVICO   0040070",500)+ ENTER
						cTxto +=PADR("21D2REGISTRO DETALH0080080'3'",500)+ ENTER
						cTxto +=PADR("21D2N. SEQ REG LOTE0090130",500)+ ENTER
						cTxto +=PADR("21D2COD. SEG. DETAL0140140SEGMENTO",500)+ ENTER
						cTxto +=PADR("21D2USO EXCL.CNAB1 0150150",500)+ ENTER
						cTxto +=PADR("21D2CODIGO MOVIMENT0160170OCORRENCIA",500)+ ENTER
						cTxto +=PADR("21D2JUR. MULT. ENCA0180322JUROS",500)+ ENTER
						cTxto +=PADR("21D2VL DESCONTO    0330472DESCONTO",500)+ ENTER
						cTxto +=PADR("21D2VL ABATIMENTO  0480622ABATIMENTO",500)+ ENTER
						cTxto +=PADR("21D2VL IOF         0630772IOF",500)+ ENTER
						cTxto +=PADR("21D2VL PAGO        0780922VALOR",500)+ ENTER
						cTxto +=PADR("21D2VL LIQUIDO     0931072",500)+ ENTER
						cTxto +=PADR("21D2OUTRAS DESP    1081222",500)+ ENTER
						cTxto +=PADR("21D2OUTROS CREDITOS1231372OUTROSCREDITOS",500)+ ENTER
						cTxto +=PADR("21D2DT OCORRENCIA  1461530DATA",500)+ ENTER					//CAS - 02/03/2021 Ajuste Data Ocorrencia
						cTxto +=PADR("21D2DT CREDITO     1461530DATACREDITO",500)+ ENTER
						cTxto +=PADR("21D2COD OCORRENCIA 1541570",500)+ ENTER
						cTxto +=PADR("21D2DT OCORRENCIA  1581650",500)+ ENTER
						cTxto +=PADR("21D2VALOR OCORRENCI1661802",500)+ ENTER
						cTxto +=PADR("21D2COMPL. DA OCORR1812100",500)+ ENTER
						cTxto +=PADR("21D2COD. BCO. CORR.2112130",500)+ ENTER
						cTxto +=PADR("21D2N.NUM BCO CORRE2142330",500)+ ENTER
						cTxto +=PADR("21D2USO EXCL.CNAB  2342400",500)+ ENTER
						cTxto +=PADR("20H COD. BANCO COMP0010030",500)+ ENTER
						cTxto +=PADR("20H LOTE DE SERVICO0040070'0000'",500)+ ENTER
						cTxto +=PADR("20H REG. HEADER ARQ0080080",500)+ ENTER
						cTxto +=PADR("20H TIPO OPERACAO  0090170",500)+ ENTER
						cTxto +=PADR("20H TIPO INSCRICAO 0180180",500)+ ENTER
						cTxto +=PADR("20H NUM INSCRICAO  0190320",500)+ ENTER
						cTxto +=PADR("20H CONVENIO BANCO 0330520",500)+ ENTER
						cTxto +=PADR("20H AGENCIA        0530570",500)+ ENTER
						cTxto +=PADR("20H DV AGENCIA     0580580",500)+ ENTER
						cTxto +=PADR("20H CONTA          0590700",500)+ ENTER
						cTxto +=PADR("20H DV CONTA       0710710",500)+ ENTER
						cTxto +=PADR("20H DV AG/CONTA    0720720",500)+ ENTER
						cTxto +=PADR("20H NOME EMPRESA   0731020",500)+ ENTER
						cTxto +=PADR("20H NOME BANCO     1031320",500)+ ENTER
						cTxto +=PADR("20H EXCLUS FEBRABAN1331420",500)+ ENTER
						cTxto +=PADR("20H COD REM/RET    1431430",500)+ ENTER
						cTxto +=PADR("20H DATA GER ARQ   1441510",500)+ ENTER
						cTxto +=PADR("20H HORA GER ARQ   1521570",500)+ ENTER
						cTxto +=PADR("20H NUM SEQ ARQ    1581630",500)+ ENTER
						cTxto +=PADR("20H VER LAYOUT     1641660'10.3'",500)+ ENTER
						cTxto +=PADR("20H DENS GRAV ARQ  1671710",500)+ ENTER
						cTxto +=PADR("20H USO RES BANCO  1721910",500)+ ENTER
						cTxto +=PADR("20H USO RES EMPRESA1922110",500)+ ENTER
						cTxto +=PADR("20H EXCLUS FEBRABAN2122400",500)+ ENTER
						cTxto +=PADR("20T COD BCO COMPENS0010030",500)+ ENTER
						cTxto +=PADR("20T LOTE SERVICO   0040070'9999'",500)+ ENTER
						cTxto +=PADR("20T TIPO REGISTRO  0080080'9'",500)+ ENTER
						cTxto +=PADR("20T EXCLUSIV FEBRAB0090170",500)+ ENTER
						cTxto +=PADR("20T QTD REG LOTE   0180230",500)+ ENTER
						cTxto +=PADR("20T QTD REG ARQ    0240290",500)+ ENTER
						cTxto +=PADR("20T QTD CONTAS     0300350",500)+ ENTER
						cTxto +=PADR("20T EXCLUSIV FEBRAB0362400",500)+ ENTER
						cTxto +=PADR("21H COD BCO COMPENS0010030",500)+ ENTER
						cTxto +=PADR("21H LOTE DE SERVICO0040070",500)+ ENTER
						cTxto +=PADR("21H REG. HEADER LOT0080080",500)+ ENTER
						cTxto +=PADR("21H TIPO OPERACAO  0090090",500)+ ENTER
						cTxto +=PADR("21H TIPO SERVICO   0100110",500)+ ENTER
						cTxto +=PADR("21H EXCLUSI FEBRABA0120130",500)+ ENTER
						cTxto +=PADR("21H NO. VER. LAYOUT0140160",500)+ ENTER
						cTxto +=PADR("21H EXCLUSI FEBRABA0170170",500)+ ENTER
						cTxto +=PADR("21H TIPO INSCR. EMP0180180",500)+ ENTER
						cTxto +=PADR("21H NO. INSCR EMPRE0190330",500)+ ENTER
						cTxto +=PADR("21H COD CONV BCO   0340530",500)+ ENTER
						cTxto +=PADR("21H AGENCIA CONTA  0540580",500)+ ENTER
						cTxto +=PADR("21H DIGITO AGENCIA 0590590",500)+ ENTER
						cTxto +=PADR("21H NRO C/C        0600710",500)+ ENTER
						cTxto +=PADR("21H DIGITO CONTA   0720720",500)+ ENTER
						cTxto +=PADR("21H DIGITO AG/CONTA0730730",500)+ ENTER
						cTxto +=PADR("21H NOME DA EMPRESA0741030",500)+ ENTER
						cTxto +=PADR("21H MENSAGEM 1     1041430",500)+ ENTER
						cTxto +=PADR("21H MENSAGEM 2     1441830",500)+ ENTER
						cTxto +=PADR("21H NRO REM/RET    1841910",500)+ ENTER
						cTxto +=PADR("21H DATAGRA REM/RET1921990",500)+ ENTER
						cTxto +=PADR("21H DATA CREDITO   2002070",500)+ ENTER
						cTxto +=PADR("21H USO EXCL.CNAB  2082400",500)+ ENTER
						cTxto +=PADR("21T COD BCO COMPENS0010030",500)+ ENTER
						cTxto +=PADR("21T LOTE SERVICO   0040070",500)+ ENTER
						cTxto +=PADR("21T REG. TRAIL LOTE0080080",500)+ ENTER
						cTxto +=PADR("21T USO EXCL.CNAB  0090170",500)+ ENTER
						cTxto +=PADR("21T QTD REG. LOTE  0180230",500)+ ENTER
						cTxto +=PADR("21T QUANT.TITULO   0240290",500)+ ENTER
						cTxto +=PADR("21T VLR. TOTAL TIT.0300462",500)+ ENTER
						cTxto +=PADR("21T QUANT.TITULO   0470520",500)+ ENTER
						cTxto +=PADR("21T VLR. TOTAL TIT.0530692",500)+ ENTER
						cTxto +=PADR("21T QUANT. TITULO  0700750",500)+ ENTER
						cTxto +=PADR("21T VLR. TOTAL TIT.0760922",500)+ ENTER
						cTxto +=PADR("21T QUANT. TITULO  0930980",500)+ ENTER
						cTxto +=PADR("21T VLR. TOTAL TIT.0991152",500)+ ENTER
						cTxto +=PADR("21T NRO AVISO LANC 1161230",500)+ ENTER
						cTxto +=PADR("21T USO EXCL.CNAB  1242400",500)+ ENTER

						//FWrite - Comando reponsavel pela gravação do texto.
						FWrite(nHandle, cTxto)
						//FClose - Comando que fecha o arquivo, liberando o uso para outros programas.
						FClose(nHandle)
					EndIf
					IF FILE(aArqLay[c])
						cMsgLayout += aArqLay[c] + ENTER
						//AVISO("ARQUIVO DE LAYOUT CRIADO COM SUCESSO","O ARQUIVO: "+aArqLay[c]+" FOI CRIADO COM SUCESSO",{"OK"}, 3)
					ENDIF
				ENDIF
			ENDIF
		NEXT

		IF !EMPTY(cMsgLayout)
			AVISO("<center><h2><font color='#7db9e8'>ARQUIVO DE LAYOUT CRIADO COM SUCESSO!!</font></h2></center>","ARQUIVOS CRIADOS: "+ENTER+cMsgLayout,{"OK"}, 3)
		ENDIF
		
					


	CASE nOPCAO == 5 //U_INFOTRIB()

		cModPag    := Posicione("SEA",1,xFilial("SEA")+SE2->E2_NUMBOR+SE2->E2_PREFIXO+SE2->E2_NUM+SE2->E2_PARCELA,"EA_MODELO")
		/////////////////////////////////////////
		/////////// Pagamento GPS ///////////////
		/////////////////////////////////////////
		If SEA->EA_MODELO$"17"
			//nVLOutEnt:= 0
			If !EMPTY(SE2->(E2_P_VRENT))
				nVLOutEnt := nVLOutEnt + SE2->(E2_P_VRENT)
				nOutEnt := STRZERO(SE2->(E2_P_VRENT)*100,15)
			Else
				nOutEnt := REPL("0",15)
			EndIf
			//nVLOutEnt := nVLOutEnt + nOutEnt
			//MSGINFO(nVLOutEnt,"Valor outra entidade Private")
			cRet:= PADR(ALLTRIM(SE2->E2_P_CODRE),6)                                         //01.N1 111 - 116 (6)    - Código da Receita do Tributo
			cRet+= PADL(ALLTRIM(SE2->E2_P_TPCON),2,'0')                                     //02.N1 117 - 118 (2)    - Tipo de Identificação do Contribuinte
			cRet+= PADL(ALLTRIM(SE2->E2_P_CGCON),14,'0')                                    //03.N1 119 - 132 (14)   - Identificação do Contribuinte - CNPJ/CGC/CPF
			cRet+= "17"                                                                     //04.N1 133 - 134 (2)    - Código de Identificação do Tributo
			cRet+= STRZERO(MONTH(SE2->E2_P_COMPE,2),2) + STRZERO(YEAR(SE2->E2_P_COMPE,4),4) //05.N1 135 - 140 (6)    - Mês e ano de competência
			cRet+= STRZERO(SE2->(E2_SALDO)*100,15)                                          //06.N1 141 - 155 (13,2) - Valor previsto do pagamento do INSS
			cRet+= nOutEnt                                                                  //07.N1 156 - 170 (13,2) - Valor de Outras Entidades
			cRet+= STRZERO(SE2->(E2_JUROS+E2_MULTA)*100,15)                       			//08.N1 171 - 185 (13,2) - Atualização Monetária
			cRet+= SPACE(45)                                                                //09.N1 186 - 230 (45)   - Uso Exclusivo FEBRABAN/CNAB
		/////////////////////////////////////////
		////// Pagamento de Darf Normal  ////////
		/////////////////////////////////////////
		ElseIf SEA->EA_MODELO$"16"
			cRet:= PADR(ALLTRIM(SE2->E2_P_CODRE),6)                                                   //01.N2 111 - 116 (6)    - Código da Receita do Tributo
			cRet+= PADL(ALLTRIM(SE2->E2_P_TPCON),2,'0')                                              //02.N2 117 - 118 (2)    - Tipo de Identificação do Contribuinte
			cRet+= PADL(ALLTRIM(SE2->E2_P_CGCON),14,'0')                                                 //03.N2 119 - 132 (14)   - Identificação do Contribuinte - CNPJ/CGC/CPF
			cRet+= "16"                                                                     //04.N2 133 - 134 (2)    - Código de Identificação do Tributo
			cRet+= GRAVADATA(SE2->E2_P_COMPE,.F.,5)	 									    //05.N2 135-142 (8)      - Período de Apuração
			cRet+= STRZERO(VAL(SE2->E2_P_REFE),17)                                          //06.N2 143-159 (17)     - Numero de referencia
			cRet+= STRZERO(SE2->(E2_SALDO+E2_ACRESC-E2_DECRESC)*100,15)				        //07.N2 160-174 (13,2)   - Valor Principal
			cRet+= STRZERO(SE2->E2_MULTA*100,15)											//08.N2 175-189 (13,2)   - Valor da Multa
			cRet+= STRZERO(SE2->E2_JUROS*100,15)										    //09.N2 190-204 (13,2)   - Valor dos Juros / Encargos
			cRet+= GRAVADATA(SE2->E2_VENCTO,.F.,5)			                                //10.N2 205-212 (8)      - Data de Vencimento
			cRet+= SPACE(18)    										                    //11.N2 213-230 (18)     - Uso Exclusivo FEBRABAN/CNAB

		/////////////////////////////////////////
		////// Pagamento de Darf Simples ////////
		/////////////////////////////////////////
		//VERIFICAR SE PRECISA CRIAR OS CAMPOS PARA "VALOR RECEITA BRUTA ACUMULADA" E "PERCENTUAL SOBRE A RECEITA BRUTA ACUMULADA"
		ElseIf SEA->EA_MODELO$"18"
			cRet:= PADR("6106",6)                                                       //01.N3 111 - 116 (6)    - Código da Receita do Tributo
			cRet+= PADL(ALLTRIM(SE2->E2_P_TPCON),2,'0')                                              //02.N3 117 - 118 (2)    - Tipo de Identificação do Contribuinte
			cRet+= PADL(ALLTRIM(SE2->E2_P_CGCON),14,'0')                                                //03.N3 119 - 132 (14)   - Identificação do Contribuinte - CNPJ/CGC/CPF
			cRet+= "18"                                                                     //04.N3 133 - 134 (2)    - Código de Identificação do Tributo
			cRet+= GRAVADATA(SE2->E2_P_COMPE,.F.,5)	 									    //05.N3 135-142 (8)      - Período de Apuração

			cRet+= STRZERO(SE2->E2_P_REBRU*100,15) 	                                        //06.N3 143-157 (13,2)   - Valor da Receita Bruta Acumulada
			cRet+= STRZERO(SE2->E2_P_PERRB,7)         				                        //07.N3 158-164 (5,2)    - Percentual sobre a Receita Bruta Acumulada

			cRet+= STRZERO(SE2->(E2_SALDO+E2_ACRESC-E2_DECRESC)*100,15)						//08.N3 165-179 (13,2)   - Valor Principal
			cRet+= STRZERO(SE2->E2_MULTA*100,15)										    //09.N3 180-194 (13,2)   - Valor da Multa
			cRet+= STRZERO(SE2->E2_JUROS*100,15)		                                    //10.N3 195-209 (13,2)   - Valor dos Juros / Encargos
			cRet+= SPACE(21)    										                    //11.N3 210-230 (21)     - Uso Exclusivo FEBRABAN/CNAB

		/////////////////////////////////////////
		/////////// Pagamento DARJ //////////////
		/////////////////////////////////////////
		//VERIFICAR A NECESSIDADE DA CRIAÇÃO DO CAMPO PARA "VALOR DA ATUALIZAÇÃO MONETÁRIA" E "NUMERO DO DOCUMENTO ORIGEM"
		ElseIf SEA->EA_MODELO$"21"

			cRet:= PADR(ALLTRIM(SE2->E2_P_CODRE),6)                                                   //01.N8 111 - 116 (6)    - Código da Receita do Tributo
			cRet+= PADL(ALLTRIM(SE2->E2_P_TPCON),2,'0')                                              //02.N8 117 - 118 (2)    - Tipo de Identificação do Contribuinte
			cRet+= PADL(ALLTRIM(SE2->E2_P_CGCON),14,'0')                                                    //03.N8 119 - 132 (14)   - Identificação do Contribuinte - CNPJ/CGC/CPF
			cRet+= PADL(ALLTRIM(SM0->M0_INSC),8,"0")                                        //04.N8 133 - 140 (8)    - Inscrição Estadual / Código do Município / Número Declaração

			cRet+= STRZERO(SE2->E2_P_DCORI,16)	 									        //05.N8 141 - 156 (16)   - Número do Documento Origem

			cRet+= STRZERO(SE2->(E2_SALDO+E2_ACRESC-E2_DECRESC)*100,15) 	                //06.N8 157 - 171 (13,2) - Valor Principal
			cRet+= STRZERO(SE2->E2_P_VLMON,15)  		                                    //07.N8 172 - 186 (13,2) - Valor da Atualização Monetária

			cRet+= STRZERO(SE2->E2_JUROS*100,15)						                    //08.N8 187 - 201 (13,2) - Valor da Mora
			cRet+= STRZERO(SE2->E2_MULTA*100,15)										    //09.N8 202 - 216 (13,2) - Valor da Multa
			cRet+= GRAVADATA(SE2->E2_VENCTO,.F.,5)		                                    //10.N8 217 - 224 (8)    - Data de Vencimento
			cRet+= SPACE(6)    										                        //11.N8 225 - 230 (6)    - Período de Referência ou número da parcela

		//////////////////////////////////////////
		// Pagamento de Gare-SP (ICMS/DR/ITCMD) //
		//////////////////////////////////////////
		//VERIFICAR SE PRECISA CRIAR OS CAMPOS PARA "DIVIDA ATIVA" E "NUMERO DE PARCELA"
		ElseIf SEA->EA_MODELO$"22"

			cRet:= PADR(ALLTRIM(SE2->E2_P_CODRE),6)                                         //01.N4 111 - 116 (6)    - Código da Receita do Tributo
			cRet+= PADL(ALLTRIM(SE2->E2_P_TPCON),2,'0')                                     //02.N4 117 - 118 (2)    - Tipo de Identificação do Contribuinte
			cRet+= PADL(ALLTRIM(SE2->E2_P_CGCON),14,'0')                                    //03.N4 119 - 132 (14)   - Identificação do Contribuinte - CNPJ/CGC/CPF
			cRet+= "22"                                                                     //04.N4 133 - 134 (2)    - Código de Identificação do Tributo
			cRet+= GRAVADATA(SE2->E2_VENCTO,.F.,5)	 									    //05.N4 135 - 142 (8)    - Data de Vencimento
			cRet+= STRZERO(VAL(SUBSTR(SE2->E2_P_INSCR,1,12)),12)							//06.N4 143 - 154 (12)   - Inscrição Estadual / Código do Município / Número Declaração
			cRet+= STRZERO(Val(SE2->E2_P_DIVAT),13)										    //07.N4 155 - 167 (13)   - Dívida Ativa / N. Etiqueta
			cRet+= STRZERO(MONTH(SE2->E2_P_COMPE,2),2)+ STRZERO(YEAR(SE2->E2_P_COMPE,4),4)	//08.N4 168 - 173 (6)    - Período de Referência
			cRet+= STRZERO(Val(SE2->E2_P_PARCE),13)											//09.N4 174 - 186 (13)   - Número da Parcela / Notificação
			cRet+= STRZERO(SE2->(E2_SALDO+E2_ACRESC-E2_DECRESC)*100,15)					    //10.N4 187 - 201 (13,2) - Valor da Receita
			cRet+= STRZERO(SE2->E2_JUROS*100,14)											//11.N4 202 - 215 (12,2) - Valor dos Juros / Encargos
			cRet+= STRZERO(SE2->E2_MULTA*100,14)			                                //12.N4 216 - 229 (12,2) - Valor da Multa
			cRet+= SPACE(1) 										                        //13.N4 230 - 230 (1)    - Uso Exclusivo FEBRABAN/CNAB

		/**************************************************************************/
		/**************************************************************************/
		/* O Itaú não aceita mais pagamento de IPVA e DPVAT sem código de barras  */
		/**************************************************************************/
		/**************************************************************************/
		//////////////////////////////////////////
		/////////// Pagamento de IPVA ///////////
		//////////////////////////////////////////
		ElseIf SEA->EA_MODELO$"25"

			cRet:= PADR(ALLTRIM(SE2->E2_P_CODRE),6)                                         //01.N5 111 - 116 (6)    - Código da Receita do Tributo
			cRet+= PADL(ALLTRIM(SE2->E2_P_TPCON),2,'0')                                     //02.N5 117 - 118 (2)    - Tipo de Identificação do Contribuinte
			cRet+= PADL(ALLTRIM(SE2->E2_P_CGCON),14,'0')                                    //03.N5 119 - 132 (14)   - Identificação do Contribuinte - CNPJ/CGC/CPF
			cRet+= "25"                                                                     //04.N5 133 - 134 (2)    - Código de Identificação do Tributo
			cRet+= STRZERO(YEAR(SE2->E2_P_COMPE,4),4)	 									//05.N5 135 - 138 (4)    - Ano Base
			cRet+= PADL(ALLTRIM(SE2->E2_P_RENAV),9,"0")								        //06.N5 139 - 147 (9)    - Código do Renavam
			cRet+= PADL(ALLTRIM(SE2->E2_P_UFIPV),2,"0")									    //07.N5 148 - 149 (2)    - Unidade da Federação
			cRet+= PADL(ALLTRIM(SE2->E2_P_CDMUN),5,"0")	                                    //08.N5 150 - 154 (5)    - Código do Município
			cRet+= PADL(STRTRAN(ALLTRIM(SE2->E2_P_PLACA),"-",""),7,"0")                     //09.N5 155 - 161 (7)    - Placa do Veículo
			cRet+= PADL(ALLTRIM(SE2->E2_P_OPPAG),1,"0")					                    //10.N5 162 - 162 (1)    - Opção de Pagamento
			cRet+= PADL(ALLTRIM(SE2->E2_P_RENAV),12,"0")									//11.N5 163 - 174 (12)   - Código do NOVO Renavam
			cRet+= SPACE(55)			                                                    //12.N5 175 - 230 (55)   - Uso Exclusivo FEBRABAN/CNAB


		//////////////////////////////////////////
		/////////// Pagamento de DPVAT //////////
		//////////////////////////////////////////
		ElseIf SEA->EA_MODELO$"27"

			cRet:= PADR(ALLTRIM(SE2->E2_P_CODRE),6)                                         //01.N6 111 - 116 (6)    - Código da Receita do Tributo
			cRet+= PADL(ALLTRIM(SE2->E2_P_TPCON),2,'0')                                     //02.N6 117 - 118 (2)    - Tipo de Identificação do Contribuinte
			cRet+= PADL(ALLTRIM(SE2->E2_P_CGCON),14,'0')                                    //03.N6 119 - 132 (14)   - Identificação do Contribuinte - CNPJ/CGC/CPF
			cRet+= "27"                                                                     //04.N6 133 - 134 (2)    - Código de Identificação do Tributo
			cRet+= STRZERO(YEAR(SE2->E2_P_COMPE,4),4)	 									//05.N6 135 - 138 (4)    - Ano Base
			
			cRet+= PADL(SE2->E2_P_RENAV,9,"0")								                //06.N6 139 - 147 (9)    - Código do Renavam


			cRet+= PADL(ALLTRIM(SE2->E2_P_UFIPV),2,"0")									    //07.N6 148 - 149 (2)    - Unidade da Federação
			cRet+= PADL(ALLTRIM(SE2->E2_P_CDMUN),5,"0")	                                    //08.N6 150 - 154 (5)    - Código do Município
			cRet+= PADL(STRTRAN(ALLTRIM(SE2->E2_P_PLACA),"-",""),7,"0")                     //09.N6 155 - 161 (7)    - Placa do Veículo
			cRet+= "5"					                                                    //10.N6 162 - 162 (1)    - Opção de Pagamento
			cRet+= PADL(SE2->E2_P_RENAV,12,"0")                                             //11.N6 163 - 174 (12)   - Código do NOVO Renavam
			
			cRet+= SPACE(55)			                                                    //12.N6 175 - 230 (55)   - Uso Exclusivo FEBRABAN/CNAB

		//////////////////////////////////////////
		////// Pagamento de Licenciamento ///////
		//////////////////////////////////////////
		ElseIf SEA->EA_MODELO$"26" //CRIAR O MODELO 26 - LICENCIAMENTO

			cRet:= PADR(ALLTRIM(SE2->E2_P_CODRE),6)                                                  //01.N7 111 - 116 (6)    - Código da Receita do Tributo
			cRet+= PADL(ALLTRIM(SE2->E2_P_TPCON),2,'0')                                              //02.N7 117 - 118 (2)    - Tipo de Identificação do Contribuinte
			cRet+= PADL(ALLTRIM(SE2->E2_P_CGCON),14,'0')                                             //03.N7 119 - 132 (14)   - Identificação do Contribuinte - CNPJ/CGC/CPF
			cRet+= "26"                                                                     //04.N7 133 - 134 (2)    - Código de Identificação do Tributo
			cRet+= STRZERO(YEAR(SE2->E2_P_COMPE,4),4)	 									//05.N7 135 - 138 (4)    - Ano Base
			cRet+= PADL(ALLTRIM(SE2->E2_P_RENAV),9,"0")								        //06.N7 139 - 147 (9)    - Código do Renavam
			cRet+= PADL(ALLTRIM(SE2->E2_P_UFIPV),2,"0")									    //07.N7 148 - 149 (2)    - Unidade da Federação
			cRet+= PADL(ALLTRIM(SE2->E2_P_CDMUN),5,"0")	                                    //08.N7 150 - 154 (5)    - Código do Município
			cRet+= PADL(STRTRAN(ALLTRIM(SE2->E2_P_PLACA),"-",""),7,"0")                     //09.N7 155 - 161 (7)    - Placa do Veículo
			cRet+= "5"					                                                    //10.N7 162 - 162 (1)    - Opção de Pagamento
			cRet+= PADL(ALLTRIM(SE2->E2_P_OPRET),1,"0")				                        //11.N7 163 - 163 (1)    - Opção de Retirada do CRVL
			cRet+= PADL(ALLTRIM(SE2->E2_P_RENAV),12,"0")									//12.N7 164 - 175 (12)   - Código do NOVO Renavam
			cRet+= SPACE(55)			                                                    //13.N7 176 - 230 (55)   - Uso Exclusivo FEBRABAN/CNAB

		ENDIF


	CASE nOPCAO == 6 //U_INFOCOMP()
		cRet:= PADR(ALLTRIM(SE2->E2_P_TRIB),2)                                                 //10.3W 177 - 178 (2)   - Identificador de Tributo
		cRet+= PADR(ALLTRIM(SE2->E2_P_CODRE),6)                                                //10.3W 179 - 184 (6)   - Código da Receita do Tributo
		cRet+= PADR(ALLTRIM(SE2->E2_P_TPCON),2) 												  //10.3W 185 - 186 (2)   - Tipo de Identificação do Contribuinte
		cRet+= PADR(ALLTRIM(SE2->E2_P_CGCON),14)                                               //10.3W 187 - 200 (14)  - Identificação do Contribuinte
		cRet+= PADR(ALLTRIM(SE2->E2_P_IDFGT),16)												  //10.3W 201 - 216 (16)  - Campo Identificador do FGTS
		cRet+= PADR(ALLTRIM(SE2->E2_P_LCSOC),9)												  //10.3W 217 - 225 (9)   - Lacre do Conectividade Social
		cRet+= PADR(ALLTRIM(SE2->E2_P_DGSOC),2)												  //10.3W 226 - 227 (2)   - Dígito do Lacre do Conectividade Social
		cRet+= SPACE(1)																  //10.3W 228 - 228 (1)   - Uso CNAB/FEBRABAN


	CASE nOPCAO == 7 //U_TPIMPRES()
		//////////////////////////////////////////
		////// Tipo de impressão 1 ou 2 ///////
		//////////////////////////////////////////
		IF SEE->EE_P_TPIMP == '1' .OR. SEE->EE_P_TPIMP == '2' .OR. EMPTY(SEE->EE_P_TPIMP) 
			cRet:= SEE->EE_P_TPIMP                                                 			//08.3S 018 - 018 (1)     - Identificação da Impressão
			cRet+= "01"                                                                     //09.3S 019 - 020 (2)     - Número da Linha a ser Impressa
			cRet+= FwCutOff(PADR((StrTran(AllTrim(SEE->EE_FOREXT1),'"','')+' '+StrTran(AllTrim(SEE->EE_FOREXT2),'"','')),140,' '),.T.)              //10.3S 021 - 160 (140)   - Mensagem a ser Impressa
			cRet+= "01"                                                                     //11.3S 161 - 162 (2)     - Tipo do Caracter a ser Impresso
			cRet+= SPACE(78)	 															//12.3S 163 - 240 (78)    - Uso Exclusivo FEBRABAN/CNAB
				
		//////////////////////////////////////////
		////// Tipo de impressão 3 ///////
		//////////////////////////////////////////
		ELSEIF SEE->EE_P_TPIMP == '3'
			cRet:= SEE->EE_P_TPIMP                                                  		//08.3S 018 - 018 (1)     - Identificação da Impressão
			cRet+= FwCutOff(PADR(StrTran(AllTrim(SEE->EE_FOREXT1),'"',''),40,' '),.T.)      //09.3S 019 - 058 (40)    - Mensagem 5
			cRet+= FwCutOff(PADR(StrTran(AllTrim(SEE->EE_FOREXT2),'"',''),40,' '),.T.)      //10.3S 059 - 098 (40)    - Mensagem 6
			cRet+= SPACE(40)                                                                //11.3S 099 - 138 (40)    - Mensagem 7
			cRet+= SPACE(40)							 									//12.3S 139 - 178 (40)    - Mensagem 8
			cRet+= SPACE(40)                         								        //13.3S 179 - 218 (40)    - Mensagem 9
			cRet+= SPACE(22)									    						//14.3S 219 - 240 (22)    - Uso Exclusivo FEBRABAN/CNAB
		ENDIF


	CASE nOPCAO == 8 //U_RETINFO()
		cVal := cDados
		DO CASE
			/////////////////////////////////////////
			//MENSAGEM PARA IMPRESSAO DE BOLETO
			/////////////////////////////////////////
			CASE cVal == "MSG1" //MSG1
				cRet := FwCutOff(SUBSTR(StrTran(SEE->EE_FORMEN1,'"',''),1,40),.T.)
			
			CASE cVal == "MSG2" //MSG2
				cRet := FwCutOff(SUBSTR(StrTran(SEE->EE_FORMEN2,'"',''),1,40),.T.)  
		ENDCASE


	CASE nOPCAO == 9 //U_MODBORD()

		AADD(aModelo,{"58","01","CREDITO EM CONTA CORRENTE","CREDITO EN CUENTA CORRIENTE","CREDIT IN CHECKING ACCOUNT"})
		AADD(aModelo,{"58","02","CHEQUE PAGAMENTO/ADMINISTRATIVO","CHEQUE PAGO/ADMINISTRATIVO","PAYMENT/ADMINISTRATIVE CHEQUE"})
		AADD(aModelo,{"58","03","DOC","DOC","DOC"})
		AADD(aModelo,{"58","04","OP A DISPOSICAO COM AVISO PARA O FAVORECIDO","ORDEN DE PAGO DISPONIBLE CON AVISO AL BENEFICIARIO","AVAILABLE PO WITH NOTICE FOR THE BENEFICIARY"})
		AADD(aModelo,{"58","05","CREDITO EM CONTA POUPANCA","CREDITO EN CAJA DE AHORROS","CREDIT IN SAVINGS ACCOUNT"})
		AADD(aModelo,{"58","10","OP `A DISPOSICAO SEM AVISO PARA O FAVORECIDO","ORDEN DE PAGO DISPONIBLE SIN AVISO AL BENEFICIARIO","AVAILABLE OP WITHOUT NOTICE TO BENEFICIARY"})
		AADD(aModelo,{"58","11","PAGAMENTO DE CONTAS/TRUBUTOS COM CÓDIGO DE BARRAS","PAGAMENTO DE CONTAS/TRUBUTOS COM CÓDIGO DE BARRAS","PAGAMENTO DE CONTAS/TRUBUTOS COM CÓDIGO DE BARRAS"})
		AADD(aModelo,{"58","13","PAGAMENTO A CONCESSIONARIAS","PAGO A CONCESIONARIAS","PAYMENT TO CAR DEALERS"})
		AADD(aModelo,{"58","16","PAGAMENTO DE TRIBUTOS - DARF NORMAL","PAGO DE TRIBUTOS - DARF NORMAL","TAXES PAYMENT - NORMAL DARF"})
		AADD(aModelo,{"58","17","PAGAMENTO DE TRIBUTOS - GPS","PAGO DE TRIBUTOS - GPS","TAXES PAYMENT - GPS"})
		AADD(aModelo,{"58","18","PAGAMENTO DE TRIBUTOS - DARF SIMPLES","PAGO DE TRIBUTOS - DARF SIMPLE","TAXES PAYMENT - SIMPLE DARF"})
		AADD(aModelo,{"58","19","TRIBUTO - IPTU/ISS/OUTROS TRIBUTOS MUNICIPAIS","TRIBUTO - IPTU/ISS/OUTROS TRIBUTOS MUNICIPAIS","TRIBUTO - IPTU/ISS/OUTROS TRIBUTOS MUNICIPAIS"})
		AADD(aModelo,{"58","21","PAGAMENTO DE TRIBUTOS - DARJ","PAGO DE TRIBUTOS - DARJ","TAXES PAYMENT - DARJ"})
		AADD(aModelo,{"58","22","TRIBUTOS GARE-SP ICMS","TRIBUTOS GARE-SP ICMS","TRIBUTOS GARE-SP ICMS"})
		AADD(aModelo,{"58","23","TRIBUTOS DARE-SP DR","TRIBUTOS DARE-SP DR","TRIBUTOS DARE-SP DR"})
		AADD(aModelo,{"58","25","TRIBUTOS IPVA (SP e MG)","TRIBUTOS IPVA (SP e MG)","TRIBUTOS IPVA (SP e MG)"})
		AADD(aModelo,{"58","26","TRIBUTOS LICENCIAMENTO","TRIBUTOS LICENCIAMENTO","TRIBUTOS LICENCIAMENTO"})
		AADD(aModelo,{"58","27","TRIBUTOS DPVAT","TRIBUTOS DPVAT","TRIBUTOS DPVAT"})
		AADD(aModelo,{"58","30","LIQUIDACAO DE TITULOS EM COBRANCA NO ITAU","LIQUIDACION DE TITULOS EN COBRANZA EN EL BANCO ITAU","BILL SETTLEMENT UNDER ITAU BANK COLLECTION"})
		AADD(aModelo,{"58","31","PAGAMENTO DE TITULOS EM OUTRO BANCO","PAGO DE TITULOS EN OTRO BANCO","PAYMENT OF BILLS AT ANOTHER BANK"})
		AADD(aModelo,{"58","35","TRIBUTOS FGTS","TRIBUTOS FGTS","TRIBUTOS FGTS"})
		AADD(aModelo,{"58","41","TED - Outro Titular","TED - Otro Titular","TED - Another Holder"})
		AADD(aModelo,{"58","43","TED - Mesmo titular","TED - Mismo titular","TED - Same Holder"})
		
		AADD(aModelo,{"59","22","PAGAMENTO TRIBUTOS","PAGAMENTO TRIBUTOS","PAGAMENTO TRIBUTOS"})

		For nI := 1 To Len(aModelo)
			If !SX5->(DbSeek(xFilial("SX5")+aModelo[nI,1]+aModelo[nI,2]))
				//MsgAlert("Modelo de bordero: ("+aModelo[nI,2]+" - "+aModelo[nI,3]+") não existe e sera criado.")
				SX5->(dbAppend( .F. ))
					SX5->X5_FILIAL    := xFilial("SX5")
					SX5->X5_TABELA    := aModelo[nI,1]
					SX5->X5_CHAVE     := aModelo[nI,2]
					SX5->X5_DESCRI    := aModelo[nI,3]
					SX5->X5_DESCSPA   := aModelo[nI,4]
					SX5->X5_DESCENG   := aModelo[nI,5]
				SX5->(dbUnlock())
				cMsgModBor += aModelo[nI,2]+" - "+aModelo[nI,3] + ENTER 

			EndIf
		Next nI
		
		IF !EMPTY(cMsgModBor)
			AVISO("<center><h3><font color='#7db9e8'>MODELOS DE BORDERO CRIADOS!!</font></h2></center>","OS MODELOS DE BODERO FORAM CRIADOS COM SUCESO: "+ENTER+cMsgModBor,{"OK"}, 3)
		ENDIF


	CASE nOPCAO == 10 //U_ConvLD()
		cStr := IF(!EMPTY(AllTrim(M->E2_CODBAR)),AllTrim(M->E2_CODBAR),IF(!EMPTY(AllTrim(M->E2_LINDIG)),AllTrim(M->E2_LINDIG),""))
		IF !EMPTY(cStr)
			// Se o Tamanho do String for menor que 44, completa com zeros até 47 dígitos. Isso é
			// necessário para Bloquetos que NÂO têm o vencimento e/ou o valor informados na LD.
			cStr := IF(LEN(cStr)<44,cStr+REPL("0",47-LEN(cStr)),cStr)
			
		ENDIF

		DO CASE
			CASE LEN(cStr) == 47
				cStr := SubStr(cStr,1,4)+SubStr(cStr,33,15)+SubStr(cStr,5,5)+SubStr(cStr,11,10)+SubStr(cStr,22,10)
			CASE LEN(cStr) == 48
			cStr := SubStr(cStr,1,11)+SubStr(cStr,13,11)+SubStr(cStr,25,11)+SubStr(cStr,37,11)
			OTHERWISE
				cStr := cStr+SPACE(48-LEN(cStr))
		EndCase
		cRet := cStr
	
	CASE nOPCAO == 11//U_CTADVFAV()
		IF cDados == "CTAFAV"
			cRet := IIF(EMPTY(SE2->E2_FORCTA),;
			            IF(AT('-',SA2->A2_NUMCON)>0,STRZERO(VAL(SUBSTR(SA2->A2_NUMCON,1,AT('-',SA2->A2_NUMCON)-1)),12),STRZERO(VAL(SUBSTR(ALLTRIM(SA2->A2_NUMCON),1,LEN(ALLTRIM(SA2->A2_NUMCON)))),12)),;
						IF(AT('-',SE2->E2_FORCTA)>0,STRZERO(VAL(SUBSTR(SE2->E2_FORCTA,1,AT('-',SE2->E2_FORCTA)-1)),12),STRZERO(VAL(SUBSTR(ALLTRIM(SE2->E2_FORCTA),1,LEN(ALLTRIM(SE2->E2_FORCTA)))),12));
						)

		ELSEIF cDados == "DACFAV"
			cRet := IIF(EMPTY(SE2->E2_FORBCO),;
			            SA2->(IF(EMPTY(A2_DVCTA),IF(AT('-',A2_NUMCON )>0,SUBSTR(A2_NUMCON,AT('-',A2_NUMCON)+1,1),RIGHT(ALLTRIM(A2_NUMCON),1)),A2_DVCTA)),;
						SE2->(IF(EMPTY(E2_FCTADV),IF(AT('-',E2_FORCTA )>0,SUBSTR(E2_FORCTA,AT('-',E2_FORCTA)+1,1),RIGHT(ALLTRIM(E2_FORCTA),1)),E2_FCTADV));
						)

		ENDIF

	//CAS - 24/06/2020 Ajustado Leiaute, tratar juros e multa no retorno do CNAB para Segmento N
	//OBS: chamada vinda do PE F650VAR 
	CASE nOPCAO == 12 //U_INFOTRIB_RETORNO()

		_aAreaSE2 := GetArea()

   		//Busca por IdCnab (sem filial)
   		SE2->(dbSetOrder(13)) // IdCnab
   		If SE2->(MsSeek(Substr(cNumTit,1,10)))
      
	  		If SE2->E2_P_TRIB $ "16"
			  	If isincallstack("FINR650")
					nMulta	:= VAL(SUBSTR(PARAMIXB[1,14],175,15))/100		//Multa
					nJuros	:= VAL(SUBSTR(PARAMIXB[1,14],190,15))/100		//Juros
				ElseIf isincallstack("FINA430")
					nMulta	:= VAL(SUBSTR(PARAMIXB[1,16],175,15))/100		//Multa
					nJuros	:= VAL(SUBSTR(PARAMIXB[1,16],190,15))/100		//Juros
				EndIf
				//nJuros  := SE2->E2_JUROS
				//nMulta  := SE2->E2_MULTA

			ElseIf SE2->E2_P_TRIB $ "17"
			  	If isincallstack("FINR650")
					nMulta	:= VAL(SUBSTR(PARAMIXB[1,14],156,15))/100		//Outras Entidades
					nJuros	:= VAL(SUBSTR(PARAMIXB[1,14],171,15))/100		//Juros+Multa
				ElseIf isincallstack("FINA430")
					nMulta	:= VAL(SUBSTR(PARAMIXB[1,16],156,15))/100		//Outras Entidades
					nJuros	:= VAL(SUBSTR(PARAMIXB[1,16],171,15))/100		//Juros+Multa
				EndIf			

			ElseIf SE2->E2_P_TRIB $ "22"
				If isincallstack("FINR650")
					nMulta 	:= VAL(SUBSTR(PARAMIXB[1,14],202,14))/100		//Multa
					nJuros	:= VAL(SUBSTR(PARAMIXB[1,14],216,14))/100		//Juros			
				ElseIf isincallstack("FINA430")
					nMulta 	:= VAL(SUBSTR(PARAMIXB[1,16],202,14))/100		//Multa
					nJuros	:= VAL(SUBSTR(PARAMIXB[1,16],216,14))/100		//Juros
				EndiF	
			EndIf

   		Endif

   		RestArea(_aAreaSE2)


	ENDCASE

Return(cRet)
*=====================================================================================================================================*
